<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>Chapter 42 Algorithmic Optimization | Toolbox for Social Scientists and Policy Analysts</title>
  <meta name="description" content="Chapter 42 Algorithmic Optimization | Toolbox for Social Scientists and Policy Analysts" />
  <meta name="generator" content="bookdown 0.31.1 and GitBook 2.6.7" />

  <meta property="og:title" content="Chapter 42 Algorithmic Optimization | Toolbox for Social Scientists and Policy Analysts" />
  <meta property="og:type" content="book" />
  <meta property="og:image" content="https://yaydede.github.io/ToolShed//png/cover2.png" />
  
  <meta name="github-repo" content="yaydede/ToolShed_draft" />

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Chapter 42 Algorithmic Optimization | Toolbox for Social Scientists and Policy Analysts" />
  
  
  <meta name="twitter:image" content="https://yaydede.github.io/ToolShed//png/cover2.png" />

<meta name="author" content="Yigit Aydede" />



  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="r-lab-4---simulation-in-r.html"/>
<link rel="next" href="imbalanced-data.html"/>
<script src="libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/fuse.js@6.4.6/dist/fuse.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />








<link href="libs/anchor-sections-1.1.0/anchor-sections.css" rel="stylesheet" />
<link href="libs/anchor-sections-1.1.0/anchor-sections-hash.css" rel="stylesheet" />
<script src="libs/anchor-sections-1.1.0/anchor-sections.js"></script>
<script src="libs/htmlwidgets-1.6.0/htmlwidgets.js"></script>
<link href="libs/datatables-css-0.0.0/datatables-crosstalk.css" rel="stylesheet" />
<script src="libs/datatables-binding-0.26/datatables.js"></script>
<link href="libs/dt-core-1.12.1/css/jquery.dataTables.min.css" rel="stylesheet" />
<link href="libs/dt-core-1.12.1/css/jquery.dataTables.extra.css" rel="stylesheet" />
<script src="libs/dt-core-1.12.1/js/jquery.dataTables.min.js"></script>
<link href="libs/nouislider-7.0.10/jquery.nouislider.min.css" rel="stylesheet" />
<script src="libs/nouislider-7.0.10/jquery.nouislider.min.js"></script>
<link href="libs/selectize-0.12.0/selectize.bootstrap3.css" rel="stylesheet" />
<script src="libs/selectize-0.12.0/selectize.min.js"></script>
<link href="libs/crosstalk-1.2.0/css/crosstalk.min.css" rel="stylesheet" />
<script src="libs/crosstalk-1.2.0/js/crosstalk.min.js"></script>


<style type="text/css">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

<style type="text/css">
/* Used with Pandoc 2.11+ new --citeproc when CSL is used */
div.csl-bib-body { }
div.csl-entry {
  clear: both;
}
.hanging div.csl-entry {
  margin-left:2em;
  text-indent:-2em;
}
div.csl-left-margin {
  min-width:2em;
  float:left;
}
div.csl-right-inline {
  margin-left:2em;
  padding-left:1em;
}
div.csl-indent {
  margin-left: 2em;
}
</style>

<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">Toolbox</a></li>

<li class="divider"></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i>Preface</a>
<ul>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#who"><i class="fa fa-check"></i>Who</a></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#acknowledgements"><i class="fa fa-check"></i>Acknowledgements</a></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#license"><i class="fa fa-check"></i>License</a></li>
</ul></li>
<li class="chapter" data-level="1" data-path="intro.html"><a href="intro.html"><i class="fa fa-check"></i><b>1</b> How we define Machine Learning</a></li>
<li class="chapter" data-level="2" data-path="preliminaries.html"><a href="preliminaries.html"><i class="fa fa-check"></i><b>2</b> Preliminaries</a>
<ul>
<li class="chapter" data-level="2.1" data-path="preliminaries.html"><a href="preliminaries.html#data-and-dataset-types"><i class="fa fa-check"></i><b>2.1</b> Data and dataset types</a></li>
<li class="chapter" data-level="2.2" data-path="preliminaries.html"><a href="preliminaries.html#plots"><i class="fa fa-check"></i><b>2.2</b> Plots</a></li>
<li class="chapter" data-level="2.3" data-path="preliminaries.html"><a href="preliminaries.html#probability-distributions-with-r"><i class="fa fa-check"></i><b>2.3</b> Probability Distributions with R</a></li>
<li class="chapter" data-level="2.4" data-path="preliminaries.html"><a href="preliminaries.html#regressions"><i class="fa fa-check"></i><b>2.4</b> Regressions</a>
<ul>
<li class="chapter" data-level="2.4.1" data-path="preliminaries.html"><a href="preliminaries.html#ordinary-least-squares-ols"><i class="fa fa-check"></i><b>2.4.1</b> Ordinary Least Squares (OLS)</a></li>
<li class="chapter" data-level="2.4.2" data-path="preliminaries.html"><a href="preliminaries.html#maximum-likelihood-estimators"><i class="fa fa-check"></i><b>2.4.2</b> Maximum Likelihood Estimators</a></li>
<li class="chapter" data-level="2.4.3" data-path="preliminaries.html"><a href="preliminaries.html#estimating-mle-with-r"><i class="fa fa-check"></i><b>2.4.3</b> Estimating MLE with R</a></li>
</ul></li>
<li class="chapter" data-level="2.5" data-path="preliminaries.html"><a href="preliminaries.html#blue"><i class="fa fa-check"></i><b>2.5</b> BLUE</a></li>
<li class="chapter" data-level="2.6" data-path="preliminaries.html"><a href="preliminaries.html#modeling-the-data"><i class="fa fa-check"></i><b>2.6</b> Modeling the data</a></li>
<li class="chapter" data-level="2.7" data-path="preliminaries.html"><a href="preliminaries.html#causal-vs.-predictive-models"><i class="fa fa-check"></i><b>2.7</b> Causal vs. Predictive Models</a>
<ul>
<li class="chapter" data-level="2.7.1" data-path="preliminaries.html"><a href="preliminaries.html#causal-models"><i class="fa fa-check"></i><b>2.7.1</b> Causal Models</a></li>
<li class="chapter" data-level="2.7.2" data-path="preliminaries.html"><a href="preliminaries.html#prediction-models"><i class="fa fa-check"></i><b>2.7.2</b> Prediction Models</a></li>
</ul></li>
<li class="chapter" data-level="2.8" data-path="preliminaries.html"><a href="preliminaries.html#simulation"><i class="fa fa-check"></i><b>2.8</b> Simulation</a></li>
</ul></li>
<li class="part"><span><b>I Formal Look at Prediction</b></span></li>
<li class="chapter" data-level="" data-path="learning-systems.html"><a href="learning-systems.html"><i class="fa fa-check"></i>Learning Systems</a></li>
<li class="chapter" data-level="3" data-path="bias-variance-tradeoff.html"><a href="bias-variance-tradeoff.html"><i class="fa fa-check"></i><b>3</b> Bias-Variance Tradeoff</a>
<ul>
<li class="chapter" data-level="3.1" data-path="bias-variance-tradeoff.html"><a href="bias-variance-tradeoff.html#estimator-and-mse"><i class="fa fa-check"></i><b>3.1</b> Estimator and MSE</a></li>
<li class="chapter" data-level="3.2" data-path="bias-variance-tradeoff.html"><a href="bias-variance-tradeoff.html#prediction---mspe"><i class="fa fa-check"></i><b>3.2</b> Prediction - MSPE</a></li>
<li class="chapter" data-level="3.3" data-path="bias-variance-tradeoff.html"><a href="bias-variance-tradeoff.html#biased-estimator-as-a-predictor"><i class="fa fa-check"></i><b>3.3</b> Biased estimator as a predictor</a></li>
<li class="chapter" data-level="3.4" data-path="bias-variance-tradeoff.html"><a href="bias-variance-tradeoff.html#dropping-a-variable-in-a-regression"><i class="fa fa-check"></i><b>3.4</b> Dropping a variable in a regression</a></li>
<li class="chapter" data-level="3.5" data-path="bias-variance-tradeoff.html"><a href="bias-variance-tradeoff.html#uncertainty-in-estimations-and-predictions"><i class="fa fa-check"></i><b>3.5</b> Uncertainty in estimations and predictions</a></li>
<li class="chapter" data-level="3.6" data-path="bias-variance-tradeoff.html"><a href="bias-variance-tradeoff.html#prediction-interval-for-unbiased-ols-predictor"><i class="fa fa-check"></i><b>3.6</b> Prediction interval for unbiased OLS predictor</a></li>
</ul></li>
<li class="chapter" data-level="4" data-path="overfitting.html"><a href="overfitting.html"><i class="fa fa-check"></i><b>4</b> Overfitting</a></li>
<li class="part"><span><b>II Nonparametric Estimations</b></span></li>
<li class="chapter" data-level="" data-path="parametric-vs.-nonparametric-methods.html"><a href="parametric-vs.-nonparametric-methods.html"><i class="fa fa-check"></i>Parametric vs. Nonparametric methods</a></li>
<li class="chapter" data-level="5" data-path="parametric-estimations.html"><a href="parametric-estimations.html"><i class="fa fa-check"></i><b>5</b> Parametric Estimations</a>
<ul>
<li class="chapter" data-level="5.1" data-path="parametric-estimations.html"><a href="parametric-estimations.html#linear-probability-models-lpm"><i class="fa fa-check"></i><b>5.1</b> Linear Probability Models (LPM)</a></li>
<li class="chapter" data-level="5.2" data-path="parametric-estimations.html"><a href="parametric-estimations.html#logistic-regression"><i class="fa fa-check"></i><b>5.2</b> Logistic Regression</a>
<ul>
<li class="chapter" data-level="5.2.1" data-path="parametric-estimations.html"><a href="parametric-estimations.html#estimating-logistic-regression"><i class="fa fa-check"></i><b>5.2.1</b> Estimating Logistic Regression</a></li>
<li class="chapter" data-level="5.2.2" data-path="parametric-estimations.html"><a href="parametric-estimations.html#cost-functions"><i class="fa fa-check"></i><b>5.2.2</b> Cost functions</a></li>
<li class="chapter" data-level="5.2.3" data-path="parametric-estimations.html"><a href="parametric-estimations.html#deviance"><i class="fa fa-check"></i><b>5.2.3</b> Deviance</a></li>
<li class="chapter" data-level="5.2.4" data-path="parametric-estimations.html"><a href="parametric-estimations.html#predictive-accuracy"><i class="fa fa-check"></i><b>5.2.4</b> Predictive accuracy</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="6" data-path="nonparametric-estimations---basics.html"><a href="nonparametric-estimations---basics.html"><i class="fa fa-check"></i><b>6</b> Nonparametric Estimations - Basics</a>
<ul>
<li class="chapter" data-level="6.1" data-path="nonparametric-estimations---basics.html"><a href="nonparametric-estimations---basics.html#density-estimations"><i class="fa fa-check"></i><b>6.1</b> Density Estimations</a></li>
<li class="chapter" data-level="6.2" data-path="nonparametric-estimations---basics.html"><a href="nonparametric-estimations---basics.html#kernel-regressions"><i class="fa fa-check"></i><b>6.2</b> Kernel regressions</a></li>
<li class="chapter" data-level="6.3" data-path="nonparametric-estimations---basics.html"><a href="nonparametric-estimations---basics.html#regression-splines"><i class="fa fa-check"></i><b>6.3</b> Regression Splines</a></li>
<li class="chapter" data-level="6.4" data-path="nonparametric-estimations---basics.html"><a href="nonparametric-estimations---basics.html#mars---multivariate-adaptive-regression-splines"><i class="fa fa-check"></i><b>6.4</b> MARS - Multivariate Adaptive Regression Splines</a></li>
<li class="chapter" data-level="6.5" data-path="nonparametric-estimations---basics.html"><a href="nonparametric-estimations---basics.html#gam---generalized-additive-model"><i class="fa fa-check"></i><b>6.5</b> GAM - Generalized Additive Model</a></li>
</ul></li>
<li class="chapter" data-level="7" data-path="smoothing.html"><a href="smoothing.html"><i class="fa fa-check"></i><b>7</b> Smoothing</a>
<ul>
<li class="chapter" data-level="7.1" data-path="smoothing.html"><a href="smoothing.html#using-bins"><i class="fa fa-check"></i><b>7.1</b> Using bins</a></li>
<li class="chapter" data-level="7.2" data-path="smoothing.html"><a href="smoothing.html#kernel-smoothing"><i class="fa fa-check"></i><b>7.2</b> Kernel smoothing</a></li>
<li class="chapter" data-level="7.3" data-path="smoothing.html"><a href="smoothing.html#locally-weighted-regression-loess"><i class="fa fa-check"></i><b>7.3</b> Locally weighted regression <code>loess()</code></a></li>
<li class="chapter" data-level="7.4" data-path="smoothing.html"><a href="smoothing.html#smooth-spline-regression"><i class="fa fa-check"></i><b>7.4</b> Smooth Spline Regression</a></li>
<li class="chapter" data-level="7.5" data-path="smoothing.html"><a href="smoothing.html#multivariate-loess"><i class="fa fa-check"></i><b>7.5</b> Multivariate Loess</a></li>
</ul></li>
<li class="chapter" data-level="8" data-path="nonparametric-classifier---knn.html"><a href="nonparametric-classifier---knn.html"><i class="fa fa-check"></i><b>8</b> Nonparametric Classifier - kNN</a>
<ul>
<li class="chapter" data-level="8.1" data-path="nonparametric-classifier---knn.html"><a href="nonparametric-classifier---knn.html#mnist-dataset"><i class="fa fa-check"></i><b>8.1</b> <code>mnist</code> Dataset</a></li>
<li class="chapter" data-level="8.2" data-path="nonparametric-classifier---knn.html"><a href="nonparametric-classifier---knn.html#linear-classifiers-again"><i class="fa fa-check"></i><b>8.2</b> Linear classifiers (again)</a></li>
<li class="chapter" data-level="8.3" data-path="nonparametric-classifier---knn.html"><a href="nonparametric-classifier---knn.html#k-nearest-neighbors"><i class="fa fa-check"></i><b>8.3</b> k-Nearest Neighbors</a></li>
<li class="chapter" data-level="8.4" data-path="nonparametric-classifier---knn.html"><a href="nonparametric-classifier---knn.html#knn-with-caret"><i class="fa fa-check"></i><b>8.4</b> kNN with caret</a>
<ul>
<li class="chapter" data-level="8.4.1" data-path="nonparametric-classifier---knn.html"><a href="nonparametric-classifier---knn.html#mnist_27"><i class="fa fa-check"></i><b>8.4.1</b> <code>mnist_27</code></a></li>
<li class="chapter" data-level="8.4.2" data-path="nonparametric-classifier---knn.html"><a href="nonparametric-classifier---knn.html#adult-dataset"><i class="fa fa-check"></i><b>8.4.2</b> Adult dataset</a></li>
</ul></li>
</ul></li>
<li class="part"><span><b>III Self-Learning</b></span></li>
<li class="chapter" data-level="9" data-path="hyperparameter-tuning.html"><a href="hyperparameter-tuning.html"><i class="fa fa-check"></i><b>9</b> Hyperparameter Tuning</a>
<ul>
<li class="chapter" data-level="9.1" data-path="hyperparameter-tuning.html"><a href="hyperparameter-tuning.html#training-validation-and-test-datasets"><i class="fa fa-check"></i><b>9.1</b> Training, validation, and test datasets</a></li>
<li class="chapter" data-level="9.2" data-path="hyperparameter-tuning.html"><a href="hyperparameter-tuning.html#splitting-the-data-randomly"><i class="fa fa-check"></i><b>9.2</b> Splitting the data randomly</a></li>
<li class="chapter" data-level="9.3" data-path="hyperparameter-tuning.html"><a href="hyperparameter-tuning.html#k-fold-cross-validation"><i class="fa fa-check"></i><b>9.3</b> k-fold cross validation</a></li>
<li class="chapter" data-level="9.4" data-path="hyperparameter-tuning.html"><a href="hyperparameter-tuning.html#grid-search"><i class="fa fa-check"></i><b>9.4</b> Grid search</a></li>
<li class="chapter" data-level="9.5" data-path="hyperparameter-tuning.html"><a href="hyperparameter-tuning.html#cross-validated-grid-search"><i class="fa fa-check"></i><b>9.5</b> Cross-validated grid search</a></li>
<li class="chapter" data-level="9.6" data-path="hyperparameter-tuning.html"><a href="hyperparameter-tuning.html#when-the-data-is-time-series"><i class="fa fa-check"></i><b>9.6</b> When the data is time-series</a></li>
</ul></li>
<li class="chapter" data-level="10" data-path="tuning-in-classification.html"><a href="tuning-in-classification.html"><i class="fa fa-check"></i><b>10</b> Tuning in Classification</a>
<ul>
<li class="chapter" data-level="10.1" data-path="tuning-in-classification.html"><a href="tuning-in-classification.html#confusion-matrix"><i class="fa fa-check"></i><b>10.1</b> Confusion matrix</a></li>
<li class="chapter" data-level="10.2" data-path="tuning-in-classification.html"><a href="tuning-in-classification.html#performance-measures"><i class="fa fa-check"></i><b>10.2</b> Performance measures</a></li>
<li class="chapter" data-level="10.3" data-path="tuning-in-classification.html"><a href="tuning-in-classification.html#roc---reciever-operating-curve"><i class="fa fa-check"></i><b>10.3</b> ROC - Reciever Operating Curve</a></li>
<li class="chapter" data-level="10.4" data-path="tuning-in-classification.html"><a href="tuning-in-classification.html#auc---area-under-the-curve"><i class="fa fa-check"></i><b>10.4</b> AUC - Area Under the Curve</a></li>
</ul></li>
<li class="chapter" data-level="11" data-path="classification-example.html"><a href="classification-example.html"><i class="fa fa-check"></i><b>11</b> Classification Example</a>
<ul>
<li class="chapter" data-level="11.1" data-path="classification-example.html"><a href="classification-example.html#lpm"><i class="fa fa-check"></i><b>11.1</b> LPM</a></li>
<li class="chapter" data-level="11.2" data-path="classification-example.html"><a href="classification-example.html#logistic-regression-1"><i class="fa fa-check"></i><b>11.2</b> Logistic Regression</a></li>
<li class="chapter" data-level="11.3" data-path="classification-example.html"><a href="classification-example.html#knn"><i class="fa fa-check"></i><b>11.3</b> kNN</a>
<ul>
<li class="chapter" data-level="11.3.1" data-path="classification-example.html"><a href="classification-example.html#knn-10-fold-cv"><i class="fa fa-check"></i><b>11.3.1</b> kNN 10-fold CV</a></li>
<li class="chapter" data-level="11.3.2" data-path="classification-example.html"><a href="classification-example.html#knn-with-caret-1"><i class="fa fa-check"></i><b>11.3.2</b> kNN with <code>caret</code></a></li>
</ul></li>
</ul></li>
<li class="part"><span><b>IV Tree-based Models</b></span></li>
<li class="chapter" data-level="12" data-path="cart.html"><a href="cart.html"><i class="fa fa-check"></i><b>12</b> CART</a>
<ul>
<li class="chapter" data-level="12.1" data-path="cart.html"><a href="cart.html#cart---classification-tree"><i class="fa fa-check"></i><b>12.1</b> CART - Classification Tree</a></li>
<li class="chapter" data-level="12.2" data-path="cart.html"><a href="cart.html#rpart---recursive-partitioning"><i class="fa fa-check"></i><b>12.2</b> <code>rpart()</code> - Recursive Partitioning</a></li>
<li class="chapter" data-level="12.3" data-path="cart.html"><a href="cart.html#pruning"><i class="fa fa-check"></i><b>12.3</b> Pruning</a></li>
<li class="chapter" data-level="12.4" data-path="cart.html"><a href="cart.html#classification-with-titanic"><i class="fa fa-check"></i><b>12.4</b> Classification with Titanic</a></li>
<li class="chapter" data-level="12.5" data-path="cart.html"><a href="cart.html#regression-tree"><i class="fa fa-check"></i><b>12.5</b> Regression Tree</a></li>
</ul></li>
<li class="chapter" data-level="13" data-path="ensemble-learning.html"><a href="ensemble-learning.html"><i class="fa fa-check"></i><b>13</b> Ensemble learning</a>
<ul>
<li class="chapter" data-level="13.1" data-path="ensemble-learning.html"><a href="ensemble-learning.html#bagging"><i class="fa fa-check"></i><b>13.1</b> Bagging</a></li>
<li class="chapter" data-level="13.2" data-path="ensemble-learning.html"><a href="ensemble-learning.html#random-forest"><i class="fa fa-check"></i><b>13.2</b> Random Forest</a></li>
<li class="chapter" data-level="13.3" data-path="ensemble-learning.html"><a href="ensemble-learning.html#boosting"><i class="fa fa-check"></i><b>13.3</b> Boosting</a>
<ul>
<li class="chapter" data-level="13.3.1" data-path="ensemble-learning.html"><a href="ensemble-learning.html#sequential-ensemble-with-gbm"><i class="fa fa-check"></i><b>13.3.1</b> Sequential ensemble with <code>gbm</code></a></li>
<li class="chapter" data-level="13.3.2" data-path="ensemble-learning.html"><a href="ensemble-learning.html#adaboost"><i class="fa fa-check"></i><b>13.3.2</b> AdaBoost</a></li>
<li class="chapter" data-level="13.3.3" data-path="ensemble-learning.html"><a href="ensemble-learning.html#extreme-gradient-boosting-xgboost"><i class="fa fa-check"></i><b>13.3.3</b> Extreme Gradient Boosting (XGBoost)</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="14" data-path="ensemble-applications.html"><a href="ensemble-applications.html"><i class="fa fa-check"></i><b>14</b> Ensemble Applications</a>
<ul>
<li class="chapter" data-level="14.1" data-path="ensemble-applications.html"><a href="ensemble-applications.html#classification"><i class="fa fa-check"></i><b>14.1</b> Classification</a></li>
<li class="chapter" data-level="14.2" data-path="ensemble-applications.html"><a href="ensemble-applications.html#regression"><i class="fa fa-check"></i><b>14.2</b> Regression</a></li>
<li class="chapter" data-level="14.3" data-path="ensemble-applications.html"><a href="ensemble-applications.html#dataset-level-explainers"><i class="fa fa-check"></i><b>14.3</b> Dataset-level explainers</a></li>
<li class="chapter" data-level="14.4" data-path="ensemble-applications.html"><a href="ensemble-applications.html#boosting-applications"><i class="fa fa-check"></i><b>14.4</b> Boosting Applications</a>
<ul>
<li class="chapter" data-level="14.4.1" data-path="ensemble-applications.html"><a href="ensemble-applications.html#regression-1"><i class="fa fa-check"></i><b>14.4.1</b> Regression</a></li>
<li class="chapter" data-level="14.4.2" data-path="ensemble-applications.html"><a href="ensemble-applications.html#random-search-with-parallel-processing"><i class="fa fa-check"></i><b>14.4.2</b> Random search with parallel processing</a></li>
<li class="chapter" data-level="14.4.3" data-path="ensemble-applications.html"><a href="ensemble-applications.html#boosting-vs.-others"><i class="fa fa-check"></i><b>14.4.3</b> Boosting vs. Others</a></li>
<li class="chapter" data-level="14.4.4" data-path="ensemble-applications.html"><a href="ensemble-applications.html#classification-1"><i class="fa fa-check"></i><b>14.4.4</b> Classification</a></li>
<li class="chapter" data-level="14.4.5" data-path="ensemble-applications.html"><a href="ensemble-applications.html#adaboost.m1"><i class="fa fa-check"></i><b>14.4.5</b> AdaBoost.M1</a></li>
<li class="chapter" data-level="14.4.6" data-path="ensemble-applications.html"><a href="ensemble-applications.html#classification-with-xgboost"><i class="fa fa-check"></i><b>14.4.6</b> Classification with XGBoost</a></li>
</ul></li>
</ul></li>
<li class="part"><span><b>V SVM &amp; Neural Networks</b></span></li>
<li class="chapter" data-level="15" data-path="support-vector-machines.html"><a href="support-vector-machines.html"><i class="fa fa-check"></i><b>15</b> Support Vector Machines</a>
<ul>
<li class="chapter" data-level="15.1" data-path="support-vector-machines.html"><a href="support-vector-machines.html#optimal-separating-classifier"><i class="fa fa-check"></i><b>15.1</b> Optimal Separating Classifier</a>
<ul>
<li class="chapter" data-level="15.1.1" data-path="support-vector-machines.html"><a href="support-vector-machines.html#the-margin"><i class="fa fa-check"></i><b>15.1.1</b> The Margin</a></li>
<li class="chapter" data-level="15.1.2" data-path="support-vector-machines.html"><a href="support-vector-machines.html#the-non-separable-case"><i class="fa fa-check"></i><b>15.1.2</b> The Non-Separable Case</a></li>
</ul></li>
<li class="chapter" data-level="15.2" data-path="support-vector-machines.html"><a href="support-vector-machines.html#nonlinear-boundary-with-kernels"><i class="fa fa-check"></i><b>15.2</b> Nonlinear Boundary with Kernels</a></li>
<li class="chapter" data-level="15.3" data-path="support-vector-machines.html"><a href="support-vector-machines.html#application-with-svm"><i class="fa fa-check"></i><b>15.3</b> Application with SVM</a></li>
</ul></li>
<li class="chapter" data-level="16" data-path="artificial-neural-networks.html"><a href="artificial-neural-networks.html"><i class="fa fa-check"></i><b>16</b> Artificial Neural Networks</a>
<ul>
<li class="chapter" data-level="16.1" data-path="artificial-neural-networks.html"><a href="artificial-neural-networks.html#neural-network---the-idea"><i class="fa fa-check"></i><b>16.1</b> Neural Network - The idea</a></li>
<li class="chapter" data-level="16.2" data-path="artificial-neural-networks.html"><a href="artificial-neural-networks.html#backpropagation"><i class="fa fa-check"></i><b>16.2</b> Backpropagation</a></li>
<li class="chapter" data-level="16.3" data-path="artificial-neural-networks.html"><a href="artificial-neural-networks.html#neural-network---more-inputs"><i class="fa fa-check"></i><b>16.3</b> Neural Network - More inputs</a></li>
<li class="chapter" data-level="16.4" data-path="artificial-neural-networks.html"><a href="artificial-neural-networks.html#deep-learning"><i class="fa fa-check"></i><b>16.4</b> Deep Learning</a></li>
</ul></li>
<li class="part"><span><b>VI Penalized Regressions</b></span></li>
<li class="chapter" data-level="" data-path="parametric-models-in-prediction.html"><a href="parametric-models-in-prediction.html"><i class="fa fa-check"></i>Parametric models in prediction</a></li>
<li class="chapter" data-level="17" data-path="ridge.html"><a href="ridge.html"><i class="fa fa-check"></i><b>17</b> Ridge</a></li>
<li class="chapter" data-level="18" data-path="lasso.html"><a href="lasso.html"><i class="fa fa-check"></i><b>18</b> Lasso</a></li>
<li class="chapter" data-level="19" data-path="adaptive-lasso.html"><a href="adaptive-lasso.html"><i class="fa fa-check"></i><b>19</b> Adaptive Lasso</a></li>
<li class="chapter" data-level="20" data-path="oracle-efficency.html"><a href="oracle-efficency.html"><i class="fa fa-check"></i><b>20</b> Oracle efficency</a></li>
<li class="part"><span><b>VII Causality and Machine Learning</b></span></li>
<li class="chapter" data-level="21" data-path="model-selection.html"><a href="model-selection.html"><i class="fa fa-check"></i><b>21</b> Model Selection</a></li>
<li class="chapter" data-level="22" data-path="sparsity.html"><a href="sparsity.html"><i class="fa fa-check"></i><b>22</b> Sparsity</a></li>
<li class="chapter" data-level="23" data-path="use-of-machine-learning-in-causality.html"><a href="use-of-machine-learning-in-causality.html"><i class="fa fa-check"></i><b>23</b> Use of Machine Learning in Causality</a></li>
<li class="part"><span><b>VIII Dimension Reduction Methods</b></span></li>
<li class="chapter" data-level="" data-path="matrix-decompositions.html"><a href="matrix-decompositions.html"><i class="fa fa-check"></i>Matrix Decompositions</a></li>
<li class="chapter" data-level="24" data-path="eigenvectors-and-eigenvalues.html"><a href="eigenvectors-and-eigenvalues.html"><i class="fa fa-check"></i><b>24</b> Eigenvectors and eigenvalues</a></li>
<li class="chapter" data-level="25" data-path="singular-value-decomposition.html"><a href="singular-value-decomposition.html"><i class="fa fa-check"></i><b>25</b> Singular Value Decomposition</a></li>
<li class="chapter" data-level="26" data-path="rankr-approximations.html"><a href="rankr-approximations.html"><i class="fa fa-check"></i><b>26</b> Rank(r) Approximations</a></li>
<li class="chapter" data-level="27" data-path="moore-penrose-inverse.html"><a href="moore-penrose-inverse.html"><i class="fa fa-check"></i><b>27</b> Moore-Penrose inverse</a></li>
<li class="chapter" data-level="28" data-path="principle-component-analysis.html"><a href="principle-component-analysis.html"><i class="fa fa-check"></i><b>28</b> Principle Component Analysis</a></li>
<li class="chapter" data-level="29" data-path="factor-analysis.html"><a href="factor-analysis.html"><i class="fa fa-check"></i><b>29</b> Factor Analysis</a></li>
<li class="chapter" data-level="30" data-path="dynamic-mode-decomposition.html"><a href="dynamic-mode-decomposition.html"><i class="fa fa-check"></i><b>30</b> Dynamic Mode Decomposition</a></li>
<li class="part"><span><b>IX Time Series</b></span></li>
<li class="chapter" data-level="" data-path="forecasting.html"><a href="forecasting.html"><i class="fa fa-check"></i>Forecasting</a></li>
<li class="chapter" data-level="31" data-path="arima-models.html"><a href="arima-models.html"><i class="fa fa-check"></i><b>31</b> ARIMA models</a>
<ul>
<li class="chapter" data-level="31.1" data-path="arima-models.html"><a href="arima-models.html#hyndman-khandakar-algorithm"><i class="fa fa-check"></i><b>31.1</b> Hyndman-Khandakar algorithm</a></li>
<li class="chapter" data-level="31.2" data-path="arima-models.html"><a href="arima-models.html#ts-plots"><i class="fa fa-check"></i><b>31.2</b> TS Plots</a></li>
<li class="chapter" data-level="31.3" data-path="arima-models.html"><a href="arima-models.html#box-cox-transformation"><i class="fa fa-check"></i><b>31.3</b> Box-Cox transformation</a></li>
<li class="chapter" data-level="31.4" data-path="arima-models.html"><a href="arima-models.html#stationarity"><i class="fa fa-check"></i><b>31.4</b> Stationarity</a></li>
<li class="chapter" data-level="31.5" data-path="arima-models.html"><a href="arima-models.html#modeling-arima"><i class="fa fa-check"></i><b>31.5</b> Modeling ARIMA</a></li>
</ul></li>
<li class="chapter" data-level="32" data-path="grid-search-for-arima.html"><a href="grid-search-for-arima.html"><i class="fa fa-check"></i><b>32</b> Grid search for ARIMA</a></li>
<li class="chapter" data-level="33" data-path="embedding.html"><a href="embedding.html"><i class="fa fa-check"></i><b>33</b> Embedding</a></li>
<li class="chapter" data-level="34" data-path="ts-with-random-forest.html"><a href="ts-with-random-forest.html"><i class="fa fa-check"></i><b>34</b> TS with Random Forest</a></li>
<li class="chapter" data-level="35" data-path="recurrent-neural-networks.html"><a href="recurrent-neural-networks.html"><i class="fa fa-check"></i><b>35</b> Recurrent Neural Networks</a></li>
<li class="part"><span><b>X Network Analysis</b></span></li>
<li class="chapter" data-level="" data-path="graphical-network-analysis.html"><a href="graphical-network-analysis.html"><i class="fa fa-check"></i>Graphical Network Analysis</a></li>
<li class="chapter" data-level="36" data-path="fundementals.html"><a href="fundementals.html"><i class="fa fa-check"></i><b>36</b> Fundementals</a>
<ul>
<li class="chapter" data-level="36.1" data-path="fundementals.html"><a href="fundementals.html#covariance"><i class="fa fa-check"></i><b>36.1</b> Covariance</a></li>
<li class="chapter" data-level="36.2" data-path="fundementals.html"><a href="fundementals.html#correlation"><i class="fa fa-check"></i><b>36.2</b> Correlation</a></li>
<li class="chapter" data-level="36.3" data-path="fundementals.html"><a href="fundementals.html#precision-matrix"><i class="fa fa-check"></i><b>36.3</b> Precision matrix</a></li>
<li class="chapter" data-level="36.4" data-path="fundementals.html"><a href="fundementals.html#semi-partial-correlation"><i class="fa fa-check"></i><b>36.4</b> Semi-partial correlation</a></li>
</ul></li>
<li class="chapter" data-level="37" data-path="regularized-covariance-matrix.html"><a href="regularized-covariance-matrix.html"><i class="fa fa-check"></i><b>37</b> Regularized covariance matrix</a>
<ul>
<li class="chapter" data-level="37.1" data-path="regularized-covariance-matrix.html"><a href="regularized-covariance-matrix.html#mle"><i class="fa fa-check"></i><b>37.1</b> MLE</a></li>
<li class="chapter" data-level="37.2" data-path="regularized-covariance-matrix.html"><a href="regularized-covariance-matrix.html#high-dimensional-data"><i class="fa fa-check"></i><b>37.2</b> High-dimensional data</a></li>
<li class="chapter" data-level="37.3" data-path="regularized-covariance-matrix.html"><a href="regularized-covariance-matrix.html#ridge-ell_2-and-glasso-ell_1"><i class="fa fa-check"></i><b>37.3</b> Ridge (<span class="math inline">\(\ell_{2}\)</span>) and glasso (<span class="math inline">\(\ell_{1}\)</span>)</a></li>
<li class="chapter" data-level="37.4" data-path="regularized-covariance-matrix.html"><a href="regularized-covariance-matrix.html#whats-graphical---graphical-ridge-or-glasso"><i class="fa fa-check"></i><b>37.4</b> What’s graphical - graphical ridge or glasso?</a></li>
</ul></li>
<li class="part"><span><b>XI Labs</b></span></li>
<li class="chapter" data-level="38" data-path="r-lab-1---basics-i.html"><a href="r-lab-1---basics-i.html"><i class="fa fa-check"></i><b>38</b> R Lab 1 - Basics I</a>
<ul>
<li class="chapter" data-level="38.1" data-path="r-lab-1---basics-i.html"><a href="r-lab-1---basics-i.html#r-rstudio-and-r-packages"><i class="fa fa-check"></i><b>38.1</b> R, RStudio, and R Packages</a></li>
<li class="chapter" data-level="38.2" data-path="r-lab-1---basics-i.html"><a href="r-lab-1---basics-i.html#rstudio"><i class="fa fa-check"></i><b>38.2</b> RStudio</a></li>
<li class="chapter" data-level="38.3" data-path="r-lab-1---basics-i.html"><a href="r-lab-1---basics-i.html#working-directory"><i class="fa fa-check"></i><b>38.3</b> Working directory</a></li>
<li class="chapter" data-level="38.4" data-path="r-lab-1---basics-i.html"><a href="r-lab-1---basics-i.html#data-types-and-stuctures"><i class="fa fa-check"></i><b>38.4</b> Data Types and Stuctures</a></li>
<li class="chapter" data-level="38.5" data-path="r-lab-1---basics-i.html"><a href="r-lab-1---basics-i.html#vectors"><i class="fa fa-check"></i><b>38.5</b> Vectors</a></li>
<li class="chapter" data-level="38.6" data-path="r-lab-1---basics-i.html"><a href="r-lab-1---basics-i.html#subsetting-vectors"><i class="fa fa-check"></i><b>38.6</b> Subsetting Vectors</a></li>
<li class="chapter" data-level="38.7" data-path="r-lab-1---basics-i.html"><a href="r-lab-1---basics-i.html#vectorization-or-vector-operations"><i class="fa fa-check"></i><b>38.7</b> Vectorization or vector operations</a></li>
<li class="chapter" data-level="38.8" data-path="r-lab-1---basics-i.html"><a href="r-lab-1---basics-i.html#matrices"><i class="fa fa-check"></i><b>38.8</b> Matrices</a></li>
<li class="chapter" data-level="38.9" data-path="r-lab-1---basics-i.html"><a href="r-lab-1---basics-i.html#matrix-operations"><i class="fa fa-check"></i><b>38.9</b> Matrix Operations</a></li>
<li class="chapter" data-level="38.10" data-path="r-lab-1---basics-i.html"><a href="r-lab-1---basics-i.html#subsetting-matrix"><i class="fa fa-check"></i><b>38.10</b> Subsetting Matrix</a></li>
<li class="chapter" data-level="38.11" data-path="r-lab-1---basics-i.html"><a href="r-lab-1---basics-i.html#r-style-guide"><i class="fa fa-check"></i><b>38.11</b> R-Style Guide</a></li>
</ul></li>
<li class="chapter" data-level="39" data-path="r-lab-2---basics-ii.html"><a href="r-lab-2---basics-ii.html"><i class="fa fa-check"></i><b>39</b> R Lab 2 - Basics II</a>
<ul>
<li class="chapter" data-level="39.1" data-path="r-lab-2---basics-ii.html"><a href="r-lab-2---basics-ii.html#data-frames-and-lists"><i class="fa fa-check"></i><b>39.1</b> Data frames and lists</a>
<ul>
<li class="chapter" data-level="39.1.1" data-path="r-lab-2---basics-ii.html"><a href="r-lab-2---basics-ii.html#lists"><i class="fa fa-check"></i><b>39.1.1</b> Lists</a></li>
<li class="chapter" data-level="39.1.2" data-path="r-lab-2---basics-ii.html"><a href="r-lab-2---basics-ii.html#data-frames"><i class="fa fa-check"></i><b>39.1.2</b> Data Frames</a></li>
<li class="chapter" data-level="39.1.3" data-path="r-lab-2---basics-ii.html"><a href="r-lab-2---basics-ii.html#reading-importing-and-writting-exporting-data-files"><i class="fa fa-check"></i><b>39.1.3</b> Reading (importing) and writting (exporting) data files</a></li>
<li class="chapter" data-level="39.1.4" data-path="r-lab-2---basics-ii.html"><a href="r-lab-2---basics-ii.html#subsetting-data-frames"><i class="fa fa-check"></i><b>39.1.4</b> Subsetting Data Frames</a></li>
<li class="chapter" data-level="39.1.5" data-path="r-lab-2---basics-ii.html"><a href="r-lab-2---basics-ii.html#plotting-from-data-frame"><i class="fa fa-check"></i><b>39.1.5</b> Plotting from data frame</a></li>
<li class="chapter" data-level="39.1.6" data-path="r-lab-2---basics-ii.html"><a href="r-lab-2---basics-ii.html#some-useful-functions"><i class="fa fa-check"></i><b>39.1.6</b> Some useful functions</a></li>
<li class="chapter" data-level="39.1.7" data-path="r-lab-2---basics-ii.html"><a href="r-lab-2---basics-ii.html#categorical-variables-in-data-frames"><i class="fa fa-check"></i><b>39.1.7</b> Categorical Variables in Data Frames</a></li>
</ul></li>
<li class="chapter" data-level="39.2" data-path="r-lab-2---basics-ii.html"><a href="r-lab-2---basics-ii.html#programming-basics"><i class="fa fa-check"></i><b>39.2</b> Programming Basics</a>
<ul>
<li class="chapter" data-level="39.2.1" data-path="r-lab-2---basics-ii.html"><a href="r-lab-2---basics-ii.html#ifelse"><i class="fa fa-check"></i><b>39.2.1</b> if/Else</a></li>
<li class="chapter" data-level="39.2.2" data-path="r-lab-2---basics-ii.html"><a href="r-lab-2---basics-ii.html#loops"><i class="fa fa-check"></i><b>39.2.2</b> Loops</a></li>
<li class="chapter" data-level="39.2.3" data-path="r-lab-2---basics-ii.html"><a href="r-lab-2---basics-ii.html#the-apply-family"><i class="fa fa-check"></i><b>39.2.3</b> The <code>apply()</code> family</a></li>
<li class="chapter" data-level="39.2.4" data-path="r-lab-2---basics-ii.html"><a href="r-lab-2---basics-ii.html#functions"><i class="fa fa-check"></i><b>39.2.4</b> Functions</a></li>
<li class="chapter" data-level="39.2.5" data-path="r-lab-2---basics-ii.html"><a href="r-lab-2---basics-ii.html#dplyr"><i class="fa fa-check"></i><b>39.2.5</b> <code>dplyr()</code></a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="40" data-path="r-lab-3---preparing-the-data.html"><a href="r-lab-3---preparing-the-data.html"><i class="fa fa-check"></i><b>40</b> R Lab 3 - Preparing the data</a>
<ul>
<li class="chapter" data-level="40.1" data-path="r-lab-3---preparing-the-data.html"><a href="r-lab-3---preparing-the-data.html#preparing-the-data-for-a-regression-analysis-with-lm"><i class="fa fa-check"></i><b>40.1</b> Preparing the data for a regression analysis with <code>lm()</code></a>
<ul>
<li class="chapter" data-level="40.1.1" data-path="r-lab-3---preparing-the-data.html"><a href="r-lab-3---preparing-the-data.html#factor-variables"><i class="fa fa-check"></i><b>40.1.1</b> Factor variables</a></li>
<li class="chapter" data-level="40.1.2" data-path="r-lab-3---preparing-the-data.html"><a href="r-lab-3---preparing-the-data.html#dummy-coding"><i class="fa fa-check"></i><b>40.1.2</b> Dummy Coding</a></li>
<li class="chapter" data-level="40.1.3" data-path="r-lab-3---preparing-the-data.html"><a href="r-lab-3---preparing-the-data.html#column-variable-names"><i class="fa fa-check"></i><b>40.1.3</b> Column (Variable) names</a></li>
<li class="chapter" data-level="40.1.4" data-path="r-lab-3---preparing-the-data.html"><a href="r-lab-3---preparing-the-data.html#data-subsetting-and-missing-values"><i class="fa fa-check"></i><b>40.1.4</b> Data subsetting and missing values</a></li>
</ul></li>
<li class="chapter" data-level="40.2" data-path="r-lab-3---preparing-the-data.html"><a href="r-lab-3---preparing-the-data.html#dummy-variable-models"><i class="fa fa-check"></i><b>40.2</b> “DUMMY” variable models</a>
<ul>
<li class="chapter" data-level="40.2.1" data-path="r-lab-3---preparing-the-data.html"><a href="r-lab-3---preparing-the-data.html#mtcars-example"><i class="fa fa-check"></i><b>40.2.1</b> <code>mtcars</code> example</a></li>
<li class="chapter" data-level="40.2.2" data-path="r-lab-3---preparing-the-data.html"><a href="r-lab-3---preparing-the-data.html#model.matrix"><i class="fa fa-check"></i><b>40.2.2</b> <code>model.matrix()</code></a></li>
<li class="chapter" data-level="40.2.3" data-path="r-lab-3---preparing-the-data.html"><a href="r-lab-3---preparing-the-data.html#example-with-a-bigger-data-set-autompg"><i class="fa fa-check"></i><b>40.2.3</b> Example with a bigger data set: <code>Autompg</code></a></li>
<li class="chapter" data-level="40.2.4" data-path="r-lab-3---preparing-the-data.html"><a href="r-lab-3---preparing-the-data.html#some-more-data-management-tools-for-subsetting-complete.cases-is.na-and-within"><i class="fa fa-check"></i><b>40.2.4</b> Some more data management tools for subsetting: <code>complete.cases()</code>, <code>is.na()</code>, and <code>within()</code></a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="41" data-path="r-lab-4---simulation-in-r.html"><a href="r-lab-4---simulation-in-r.html"><i class="fa fa-check"></i><b>41</b> R Lab 4 - Simulation in R</a>
<ul>
<li class="chapter" data-level="41.1" data-path="r-lab-4---simulation-in-r.html"><a href="r-lab-4---simulation-in-r.html#sampling-in-r-sample"><i class="fa fa-check"></i><b>41.1</b> Sampling in R: <code>sample()</code></a></li>
<li class="chapter" data-level="41.2" data-path="r-lab-4---simulation-in-r.html"><a href="r-lab-4---simulation-in-r.html#random-number-generating-with-probablity-distributions"><i class="fa fa-check"></i><b>41.2</b> Random number generating with probablity distributions</a></li>
<li class="chapter" data-level="41.3" data-path="r-lab-4---simulation-in-r.html"><a href="r-lab-4---simulation-in-r.html#simulation-for-statistical-inference"><i class="fa fa-check"></i><b>41.3</b> Simulation for statistical inference</a></li>
<li class="chapter" data-level="41.4" data-path="r-lab-4---simulation-in-r.html"><a href="r-lab-4---simulation-in-r.html#creataing-data-with-a-data-generating-model-dgm"><i class="fa fa-check"></i><b>41.4</b> Creataing data with a Data Generating Model (DGM)</a></li>
<li class="chapter" data-level="41.5" data-path="r-lab-4---simulation-in-r.html"><a href="r-lab-4---simulation-in-r.html#bootstrapping"><i class="fa fa-check"></i><b>41.5</b> Bootstrapping</a></li>
<li class="chapter" data-level="41.6" data-path="r-lab-4---simulation-in-r.html"><a href="r-lab-4---simulation-in-r.html#monty-hall---fun-example"><i class="fa fa-check"></i><b>41.6</b> Monty Hall - Fun example</a></li>
</ul></li>
<li class="part"><span><b>XII Appendix</b></span></li>
<li class="chapter" data-level="42" data-path="algorithmic-optimization.html"><a href="algorithmic-optimization.html"><i class="fa fa-check"></i><b>42</b> Algorithmic Optimization</a>
<ul>
<li class="chapter" data-level="42.1" data-path="algorithmic-optimization.html"><a href="algorithmic-optimization.html#brute-force-optimization"><i class="fa fa-check"></i><b>42.1</b> Brute-force optimization</a></li>
<li class="chapter" data-level="42.2" data-path="algorithmic-optimization.html"><a href="algorithmic-optimization.html#derivative-based-methods"><i class="fa fa-check"></i><b>42.2</b> Derivative-based methods</a></li>
<li class="chapter" data-level="42.3" data-path="algorithmic-optimization.html"><a href="algorithmic-optimization.html#ml-estimation-with-logistic-regression"><i class="fa fa-check"></i><b>42.3</b> ML Estimation with logistic regression</a></li>
<li class="chapter" data-level="42.4" data-path="algorithmic-optimization.html"><a href="algorithmic-optimization.html#gradient-descent-algorithm"><i class="fa fa-check"></i><b>42.4</b> Gradient Descent Algorithm</a>
<ul>
<li class="chapter" data-level="42.4.1" data-path="algorithmic-optimization.html"><a href="algorithmic-optimization.html#one-variable"><i class="fa fa-check"></i><b>42.4.1</b> One-variable</a></li>
<li class="chapter" data-level="42.4.2" data-path="algorithmic-optimization.html"><a href="algorithmic-optimization.html#multivariable"><i class="fa fa-check"></i><b>42.4.2</b> Multivariable</a></li>
</ul></li>
<li class="chapter" data-level="42.5" data-path="algorithmic-optimization.html"><a href="algorithmic-optimization.html#optimization-with-r"><i class="fa fa-check"></i><b>42.5</b> Optimization with R</a></li>
</ul></li>
<li class="chapter" data-level="43" data-path="imbalanced-data.html"><a href="imbalanced-data.html"><i class="fa fa-check"></i><b>43</b> Imbalanced Data</a>
<ul>
<li class="chapter" data-level="43.1" data-path="imbalanced-data.html"><a href="imbalanced-data.html#smote"><i class="fa fa-check"></i><b>43.1</b> <code>SMOTE</code></a></li>
<li class="chapter" data-level="43.2" data-path="imbalanced-data.html"><a href="imbalanced-data.html#fraud-detection"><i class="fa fa-check"></i><b>43.2</b> Fraud detection</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="references.html"><a href="references.html"><i class="fa fa-check"></i>References</a></li>
<li class="divider"></li>
<li><a href="https://github.com/yaydede/ToolShed" target="blank">&copy; 2020 - 2022 Yigit Aydede</a></li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Toolbox for Social Scientists and Policy Analysts</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="algorithmic-optimization" class="section level1 hasAnchor" number="42">
<h1><span class="header-section-number">Chapter 42</span> Algorithmic Optimization<a href="algorithmic-optimization.html#algorithmic-optimization" class="anchor-section" aria-label="Anchor link to header"></a></h1>
<p>Here is a definition of algorithmic optimization from <a href="https://en.wikipedia.org/wiki/Mathematical_optimization#Optimization_algorithms">Wikipedia</a>:</p>
<blockquote>
<p>An optimization algorithm is a procedure which is executed iteratively by comparing various solutions until an optimum or a satisfactory solution is found. Optimization algorithms help us to minimize or maximize an objective function <span class="math inline">\(F(x)\)</span> with respect to the internal parameters of a model mapping a set of predictors (<span class="math inline">\(X\)</span>) to target values(<span class="math inline">\(Y\)</span>). There are three types of optimization algorithms which are widely used; <strong><em>Zero-Order Algorithms, First-Order Optimization Algorithms, and Second-Order Optimization Algorithms</em></strong>. Zero-order (or derivative-free) algorithms use only the criterion value at some positions. <strong><em>It is popular when the gradient and Hessian information are difficult to obtain, e.g., no explicit function forms are given</em></strong>. First Order Optimization Algorithms minimize or maximize a Loss function <span class="math inline">\(F(x)\)</span> using its Gradient values with respect to the parameters. Most widely used First order optimization algorithm is Gradient Descent. The First order derivative displays whether the function is decreasing or increasing at a particular point.</p>
</blockquote>
<p>In this appendix, we will review some important concepts in algorithmic optimization.</p>
<div id="brute-force-optimization" class="section level2 hasAnchor" number="42.1">
<h2><span class="header-section-number">42.1</span> Brute-force optimization<a href="algorithmic-optimization.html#brute-force-optimization" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>Let’s look at a simplified example about optimal retirement-plan and solve it with a zero-order algorithm.</p>
<p>Suppose that there are 2 groups of workers who are planning for their retirement at the age of 65. Both consider spending 40,000 dollars each year for the rest of their lives after retirement. On average, people in both groups expect to live 20 more years after retirement with some uncertainty. The people in the first group (A) have the following risk profile: 85% chance to live 20 years and 15% chance to live 30 years. The same risk profile for the people in the second group (B) is: 99% for 20 years and 1% for 30 years. Suppose that in each group, their utility (objective) function is <span class="math inline">\(U=C^{0.5}\)</span>.</p>
<p>What’s the maximum premium (lump-sum payment) that a person in each group would be willing to pay for a life-time annuity of 40K?</p>
<p>Without a pension plan, people in each group have the following utilities:</p>
<div class="sourceCode" id="cb1661"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1661-1"><a href="algorithmic-optimization.html#cb1661-1" aria-hidden="true" tabindex="-1"></a><span class="co">#For people in group A</span></span>
<span id="cb1661-2"><a href="algorithmic-optimization.html#cb1661-2" aria-hidden="true" tabindex="-1"></a>U_A <span class="ot">=</span> <span class="fl">0.85</span><span class="sc">*</span><span class="fu">sqrt</span>(<span class="dv">40000</span><span class="sc">*</span><span class="dv">20</span>) <span class="sc">+</span> <span class="fl">0.15</span><span class="sc">*</span><span class="fu">sqrt</span>(<span class="dv">10</span><span class="sc">*</span><span class="dv">0</span>)</span>
<span id="cb1661-3"><a href="algorithmic-optimization.html#cb1661-3" aria-hidden="true" tabindex="-1"></a>U_A</span></code></pre></div>
<pre><code>## [1] 760.2631</code></pre>
<div class="sourceCode" id="cb1663"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1663-1"><a href="algorithmic-optimization.html#cb1663-1" aria-hidden="true" tabindex="-1"></a><span class="co">#For people in group B</span></span>
<span id="cb1663-2"><a href="algorithmic-optimization.html#cb1663-2" aria-hidden="true" tabindex="-1"></a>U_B <span class="ot">=</span> <span class="fl">0.99</span><span class="sc">*</span><span class="fu">sqrt</span>(<span class="dv">40000</span><span class="sc">*</span><span class="dv">20</span>) <span class="sc">+</span> <span class="fl">0.01</span><span class="sc">*</span><span class="fu">sqrt</span>(<span class="dv">10</span><span class="sc">*</span><span class="dv">0</span>)</span>
<span id="cb1663-3"><a href="algorithmic-optimization.html#cb1663-3" aria-hidden="true" tabindex="-1"></a>U_B</span></code></pre></div>
<pre><code>## [1] 885.4829</code></pre>
<p>For example, they would not pay 200,000 dollars to cover their retirement because that would make them worse than their current situation (without a pension plan).</p>
<div class="sourceCode" id="cb1665"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1665-1"><a href="algorithmic-optimization.html#cb1665-1" aria-hidden="true" tabindex="-1"></a><span class="co">#For people in group A</span></span>
<span id="cb1665-2"><a href="algorithmic-optimization.html#cb1665-2" aria-hidden="true" tabindex="-1"></a>U_A <span class="ot">=</span> <span class="fl">0.85</span><span class="sc">*</span><span class="fu">sqrt</span>(<span class="dv">40000</span><span class="sc">*</span><span class="dv">20</span> <span class="sc">-</span> <span class="dv">200000</span>) <span class="sc">+</span> <span class="fl">0.15</span><span class="sc">*</span><span class="fu">sqrt</span>(<span class="dv">40000</span><span class="sc">*</span><span class="dv">10</span> <span class="sc">-</span> <span class="dv">200000</span>) </span>
<span id="cb1665-3"><a href="algorithmic-optimization.html#cb1665-3" aria-hidden="true" tabindex="-1"></a>U_A</span></code></pre></div>
<pre><code>## [1] 725.4892</code></pre>
<div class="sourceCode" id="cb1667"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1667-1"><a href="algorithmic-optimization.html#cb1667-1" aria-hidden="true" tabindex="-1"></a><span class="co">#For people in group B</span></span>
<span id="cb1667-2"><a href="algorithmic-optimization.html#cb1667-2" aria-hidden="true" tabindex="-1"></a>U_B <span class="ot">=</span> <span class="fl">0.99</span><span class="sc">*</span><span class="fu">sqrt</span>(<span class="dv">40000</span><span class="sc">*</span><span class="dv">20</span> <span class="sc">-</span> <span class="dv">200000</span>) <span class="sc">+</span> <span class="fl">0.01</span><span class="sc">*</span><span class="fu">sqrt</span>(<span class="dv">40000</span><span class="sc">*</span><span class="dv">10</span> <span class="sc">-</span> <span class="dv">200000</span>)</span>
<span id="cb1667-3"><a href="algorithmic-optimization.html#cb1667-3" aria-hidden="true" tabindex="-1"></a>U_B</span></code></pre></div>
<pre><code>## [1] 771.3228</code></pre>
<p>Hence, the payment they would be willing to make for reduction in uncertainty during their retirement should not make them worse off. Or more technically, their utility should not be lower than their current utility levels. Therefore <em>Pmax</em>, the maximum premium that a person would be willing to pay, can be found by minimizing the following <strong>cost function</strong> for people, for example, in Group A:</p>
<p><span class="math display">\[
\begin{aligned} F(Pmax) = p r * \sqrt{\$ 40000 * 20 y e a r s-\operatorname{Pmax}}+(1-p r) * &amp; \sqrt{\$ 40000 * 10 y e a r s-\operatorname{Pmax}} \\ &amp;-p r * \sqrt{\$ 40000 * 20 y e a r s} \end{aligned}
\]</span></p>
<p>Here is the iteration to solve for Pmax for people in Group A. We created a cost function, <em>costf</em>, that we try to minimize. Change the parameters to play with it. The same algorithm can be used to find <strong>Pmax</strong> for people in Group B.</p>
<div class="sourceCode" id="cb1669"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1669-1"><a href="algorithmic-optimization.html#cb1669-1" aria-hidden="true" tabindex="-1"></a>pr <span class="ot">&lt;-</span> <span class="fl">0.85</span></span>
<span id="cb1669-2"><a href="algorithmic-optimization.html#cb1669-2" aria-hidden="true" tabindex="-1"></a>w1 <span class="ot">&lt;-</span> <span class="dv">800000</span></span>
<span id="cb1669-3"><a href="algorithmic-optimization.html#cb1669-3" aria-hidden="true" tabindex="-1"></a>w2 <span class="ot">&lt;-</span> <span class="dv">400000</span></span>
<span id="cb1669-4"><a href="algorithmic-optimization.html#cb1669-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1669-5"><a href="algorithmic-optimization.html#cb1669-5" aria-hidden="true" tabindex="-1"></a>converged <span class="ot">=</span> F</span>
<span id="cb1669-6"><a href="algorithmic-optimization.html#cb1669-6" aria-hidden="true" tabindex="-1"></a>iterations <span class="ot">=</span> <span class="dv">0</span></span>
<span id="cb1669-7"><a href="algorithmic-optimization.html#cb1669-7" aria-hidden="true" tabindex="-1"></a>maxiter <span class="ot">&lt;-</span> <span class="dv">600000</span></span>
<span id="cb1669-8"><a href="algorithmic-optimization.html#cb1669-8" aria-hidden="true" tabindex="-1"></a>learnrate <span class="ot">&lt;-</span> <span class="fl">0.5</span></span>
<span id="cb1669-9"><a href="algorithmic-optimization.html#cb1669-9" aria-hidden="true" tabindex="-1"></a>Pmax <span class="ot">&lt;-</span> <span class="dv">10000</span></span>
<span id="cb1669-10"><a href="algorithmic-optimization.html#cb1669-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1669-11"><a href="algorithmic-optimization.html#cb1669-11" aria-hidden="true" tabindex="-1"></a><span class="cf">while</span>(converged <span class="sc">==</span> <span class="cn">FALSE</span>){</span>
<span id="cb1669-12"><a href="algorithmic-optimization.html#cb1669-12" aria-hidden="true" tabindex="-1"></a>  costf <span class="ot">&lt;-</span> pr<span class="sc">*</span><span class="fu">sqrt</span>(w1 <span class="sc">-</span> Pmax) <span class="sc">+</span> (<span class="dv">1</span><span class="sc">-</span>pr)<span class="sc">*</span><span class="fu">sqrt</span>(w2 <span class="sc">-</span> Pmax) <span class="sc">-</span> pr<span class="sc">*</span><span class="fu">sqrt</span>(w1)</span>
<span id="cb1669-13"><a href="algorithmic-optimization.html#cb1669-13" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span>(costf <span class="sc">&gt;</span> <span class="dv">0</span>){</span>
<span id="cb1669-14"><a href="algorithmic-optimization.html#cb1669-14" aria-hidden="true" tabindex="-1"></a>    Pmax <span class="ot">&lt;-</span> Pmax <span class="sc">+</span> learnrate</span>
<span id="cb1669-15"><a href="algorithmic-optimization.html#cb1669-15" aria-hidden="true" tabindex="-1"></a>    iterations <span class="ot">=</span> iterations <span class="sc">+</span> <span class="dv">1</span></span>
<span id="cb1669-16"><a href="algorithmic-optimization.html#cb1669-16" aria-hidden="true" tabindex="-1"></a>    <span class="co">#cat(&quot;Iterations: &quot;, iterations, &quot;\r&quot;)</span></span>
<span id="cb1669-17"><a href="algorithmic-optimization.html#cb1669-17" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span>(iterations <span class="sc">&gt;</span> maxiter) { </span>
<span id="cb1669-18"><a href="algorithmic-optimization.html#cb1669-18" aria-hidden="true" tabindex="-1"></a>      <span class="fu">print</span>(<span class="st">&quot;It cannot converge before finding the optimal Pmax&quot;</span>)</span>
<span id="cb1669-19"><a href="algorithmic-optimization.html#cb1669-19" aria-hidden="true" tabindex="-1"></a>      <span class="cf">break</span></span>
<span id="cb1669-20"><a href="algorithmic-optimization.html#cb1669-20" aria-hidden="true" tabindex="-1"></a>      }  </span>
<span id="cb1669-21"><a href="algorithmic-optimization.html#cb1669-21" aria-hidden="true" tabindex="-1"></a>   converged <span class="ot">=</span> <span class="cn">FALSE</span></span>
<span id="cb1669-22"><a href="algorithmic-optimization.html#cb1669-22" aria-hidden="true" tabindex="-1"></a>  }<span class="cf">else</span>{</span>
<span id="cb1669-23"><a href="algorithmic-optimization.html#cb1669-23" aria-hidden="true" tabindex="-1"></a>    converged <span class="ot">=</span> <span class="cn">TRUE</span></span>
<span id="cb1669-24"><a href="algorithmic-optimization.html#cb1669-24" aria-hidden="true" tabindex="-1"></a>  <span class="fu">print</span>(<span class="fu">paste</span>(<span class="st">&quot;Maximum Premium:&quot;</span>, Pmax, <span class="st">&quot;achieved with&quot;</span>, iterations, <span class="st">&quot;iterations&quot;</span>))</span>
<span id="cb1669-25"><a href="algorithmic-optimization.html#cb1669-25" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb1669-26"><a href="algorithmic-optimization.html#cb1669-26" aria-hidden="true" tabindex="-1"></a>}</span></code></pre></div>
<pre><code>## [1] &quot;Maximum Premium: 150043 achieved with 280086 iterations&quot;</code></pre>
<div class="sourceCode" id="cb1671"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1671-1"><a href="algorithmic-optimization.html#cb1671-1" aria-hidden="true" tabindex="-1"></a><span class="co">#let&#39;s verify it by uniroot() which finds the roots for f(x)=0</span></span>
<span id="cb1671-2"><a href="algorithmic-optimization.html#cb1671-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(stats)</span>
<span id="cb1671-3"><a href="algorithmic-optimization.html#cb1671-3" aria-hidden="true" tabindex="-1"></a>costf <span class="ot">&lt;-</span> <span class="cf">function</span>(x){<span class="fl">0.85</span><span class="sc">*</span><span class="fu">sqrt</span>(<span class="dv">800000</span> <span class="sc">-</span> x) <span class="sc">+</span> (<span class="dv">1</span><span class="fl">-0.85</span>)<span class="sc">*</span><span class="fu">sqrt</span>(<span class="dv">400000</span> <span class="sc">-</span> x) <span class="sc">-</span> pr<span class="sc">*</span><span class="fu">sqrt</span>(<span class="dv">800000</span>)}</span>
<span id="cb1671-4"><a href="algorithmic-optimization.html#cb1671-4" aria-hidden="true" tabindex="-1"></a><span class="fu">paste</span>(<span class="st">&quot;Unitroot, i.e. f(x) = 0, is &quot;</span>, <span class="fu">uniroot</span>(costf, <span class="fu">c</span>(<span class="dv">10000</span>, <span class="dv">200000</span>))<span class="sc">$</span>root)</span></code></pre></div>
<pre><code>## [1] &quot;Unitroot, i.e. f(x) = 0, is  150042.524874307&quot;</code></pre>
<p>There are better functions we could use for this purpose, but this example works well for our experiment. There is a couple of important parameters in our algorithm. The first one is the starting <code>Pmax</code>, which can be set up manually. If the starting value is too low, iteration could not converge. If it’s too high, it can give us an error. Another issue is that our iteration does not know if the learning rate should increase or decrease when the starting value is too high or too low. This can be done with additional lines of code, but we will not address it here. This situation leads us to the learning rate: the incremental change in the value of the parameter. This parameter should be conditioned on the value of cost function. If the cost function for a given <code>Pmax</code> is negative, for example, the learning rate should be negative. Secondly, the number of maximum iterations ,ust be set properly, otherwise the algorithm may not converge or take too long to converge. In the next section, we will address these issues with a smarter algorithm:</p>
<p>There are other types of approaches. In one of these, the algorithm creates a grid of <code>Pmax</code> and then try all the possible values to see which one approximately makes the cost function minimum.</p>
</div>
<div id="derivative-based-methods" class="section level2 hasAnchor" number="42.2">
<h2><span class="header-section-number">42.2</span> Derivative-based methods<a href="algorithmic-optimization.html#derivative-based-methods" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>One of the derivative-based methods is the <strong>Newton-Raphson</strong> method. If we assume that the function is differentiable and has only one minimum (maximum), we can develop an optimization algorithm that looks for the point in parameter space where the derivative of the function is zero. There are other methods, like <a href="https://en.wikipedia.org/wiki/Scoring_algorithm">Fisher Scoring</a> and <a href="https://en.wikipedia.org/wiki/Iteratively_reweighted_least_squares">Iteratively Reweighted Least Squares</a>, that we will not see here.</p>
<p>First let’s see the Newton-Raphson method. This is a well-known extension of your calculus class about derivatives in High School. The method is very simple and used to find the roots of <span class="math inline">\(f(x)=0\)</span> by iterations. In first-year computer science courses, this method is used to teach loop algorithms that calculate the value of, for example, <span class="math inline">\(e^{0.71}\)</span> or <span class="math inline">\(\sqrt{12}\)</span>. It is a simple iteration that converges in a few steps.</p>
<p><span class="math display">\[
x_{n+1}=x_{n}-\frac{f\left(x_{n}\right)}{f^{\prime}\left(x_{n}\right)}
\]</span>
To understand it, let’s look at the function <span class="math inline">\(y=f(x)\)</span> shown in the following graph:</p>
<p><img src="png/RN.png" width="80%" height="80%" /></p>
<p>It has a zero at <span class="math inline">\(x=x_r\)</span>, which is not known. To find it, we start with <span class="math inline">\(x_0\)</span> as an initial estimate of <span class="math inline">\(X_r\)</span>. The tangent line to the graph at the point <span class="math inline">\(\left(x_0, f\left(x_0\right)\right)\)</span> has the point <span class="math inline">\(x_1\)</span> at which the tangent crosses the <span class="math inline">\(x\)</span>-axis. The slope of this line can be defined as</p>
<p><span class="math display">\[
\frac{y-f\left(x_0\right)}{x-x_0}=f^{\prime}\left(x_0\right)
\]</span>
Hence,</p>
<p><span class="math display">\[
y-f\left(x_0\right)=f^{\prime}\left(x_0\right)\left(x-x_0\right)
\]</span>
At the point where the tangent line cross the <span class="math inline">\(x\)</span>-axis, <span class="math inline">\(y=0\)</span> and <span class="math inline">\(x=x_1\)</span>. Hence solving the equation for <span class="math inline">\(x_1\)</span>, we get</p>
<p><span class="math display">\[
x_{1}=x_{0}-\frac{f\left(x_{0}\right)}{f^{\prime}\left(x_{0}\right)}
\]</span>
And the second approximations:</p>
<p><span class="math display">\[
x_{2}=x_{1}-\frac{f\left(x_{1}\right)}{f^{\prime}\left(x_{1}\right)}
\]</span>
And with multiple iterations one can find the solution. Here is the example:</p>
<div class="sourceCode" id="cb1673"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1673-1"><a href="algorithmic-optimization.html#cb1673-1" aria-hidden="true" tabindex="-1"></a>newton <span class="ot">&lt;-</span> <span class="cf">function</span>(f, x0, <span class="at">tol =</span> <span class="fl">1e-5</span>, <span class="at">n =</span> <span class="dv">1000</span>) {</span>
<span id="cb1673-2"><a href="algorithmic-optimization.html#cb1673-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">require</span>(numDeriv) <span class="co"># Package for computing f&#39;(x)</span></span>
<span id="cb1673-3"><a href="algorithmic-optimization.html#cb1673-3" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb1673-4"><a href="algorithmic-optimization.html#cb1673-4" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>n) {</span>
<span id="cb1673-5"><a href="algorithmic-optimization.html#cb1673-5" aria-hidden="true" tabindex="-1"></a>    dx <span class="ot">&lt;-</span> <span class="fu">genD</span>(<span class="at">func =</span> f, <span class="at">x =</span> x0)<span class="sc">$</span>D[<span class="dv">1</span>] <span class="co"># First-order derivative f&#39;(x0)</span></span>
<span id="cb1673-6"><a href="algorithmic-optimization.html#cb1673-6" aria-hidden="true" tabindex="-1"></a>    x1 <span class="ot">&lt;-</span> x0 <span class="sc">-</span> (<span class="fu">f</span>(x0) <span class="sc">/</span> dx) <span class="co"># Calculate next value x1</span></span>
<span id="cb1673-7"><a href="algorithmic-optimization.html#cb1673-7" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> (<span class="fu">abs</span>(x1 <span class="sc">-</span> x0) <span class="sc">&lt;</span> tol) {</span>
<span id="cb1673-8"><a href="algorithmic-optimization.html#cb1673-8" aria-hidden="true" tabindex="-1"></a>      res <span class="ot">&lt;-</span> <span class="fu">paste</span>(<span class="st">&quot;Root approximation is &quot;</span>, x1, <span class="st">&quot; in &quot;</span>, i, <span class="st">&quot; iterations&quot;</span>)</span>
<span id="cb1673-9"><a href="algorithmic-optimization.html#cb1673-9" aria-hidden="true" tabindex="-1"></a>      <span class="fu">return</span>(res)</span>
<span id="cb1673-10"><a href="algorithmic-optimization.html#cb1673-10" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb1673-11"><a href="algorithmic-optimization.html#cb1673-11" aria-hidden="true" tabindex="-1"></a>    <span class="co"># If Newton-Raphson has not yet reached convergence set x1 as x0 and continue</span></span>
<span id="cb1673-12"><a href="algorithmic-optimization.html#cb1673-12" aria-hidden="true" tabindex="-1"></a>    x0 <span class="ot">&lt;-</span> x1</span>
<span id="cb1673-13"><a href="algorithmic-optimization.html#cb1673-13" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb1673-14"><a href="algorithmic-optimization.html#cb1673-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">print</span>(<span class="st">&#39;Too many iterations in method&#39;</span>)</span>
<span id="cb1673-15"><a href="algorithmic-optimization.html#cb1673-15" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb1673-16"><a href="algorithmic-optimization.html#cb1673-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1673-17"><a href="algorithmic-optimization.html#cb1673-17" aria-hidden="true" tabindex="-1"></a>func2 <span class="ot">&lt;-</span> <span class="cf">function</span>(x) {</span>
<span id="cb1673-18"><a href="algorithmic-optimization.html#cb1673-18" aria-hidden="true" tabindex="-1"></a>  x<span class="sc">^</span><span class="dv">15</span> <span class="sc">-</span> <span class="dv">2</span></span>
<span id="cb1673-19"><a href="algorithmic-optimization.html#cb1673-19" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb1673-20"><a href="algorithmic-optimization.html#cb1673-20" aria-hidden="true" tabindex="-1"></a><span class="fu">newton</span>(func2, <span class="dv">1</span>)</span></code></pre></div>
<pre><code>## [1] &quot;Root approximation is  1.04729412282063  in  5  iterations&quot;</code></pre>
<div class="sourceCode" id="cb1675"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1675-1"><a href="algorithmic-optimization.html#cb1675-1" aria-hidden="true" tabindex="-1"></a><span class="co">#Check it</span></span>
<span id="cb1675-2"><a href="algorithmic-optimization.html#cb1675-2" aria-hidden="true" tabindex="-1"></a><span class="fu">paste</span>(<span class="st">&quot;Calculator result: &quot;</span>, <span class="dv">2</span><span class="sc">^</span>(<span class="dv">1</span><span class="sc">/</span><span class="dv">15</span>))</span></code></pre></div>
<pre><code>## [1] &quot;Calculator result:  1.04729412282063&quot;</code></pre>
<p>Newton’s method is often used to solve two different, but related, problems:</p>
<ol style="list-style-type: decimal">
<li>Finding <span class="math inline">\(x\)</span> such that <span class="math inline">\(f(x)=0\)</span> (<strong>Try to solve our insurance problem with this method</strong>)</li>
<li>Finding <span class="math inline">\(x\)</span> that <span class="math inline">\(g&#39;(x)=0\)</span>, or find <span class="math inline">\(x\)</span> that minimizes/maximizes <span class="math inline">\(g(x)\)</span>.</li>
</ol>
<p>The relation between these two problems is obvious when we define <span class="math inline">\(f(x) = g&#39;(x)\)</span>. Hence, for the second problem, the Newton-Raphson method becomes:</p>
<p><span class="math display">\[
x_{n+1}=x_{n}-\frac{g^{\prime}\left(x_{n}\right)}{g^{\prime \prime}\left(x_{n}\right)}
\]</span></p>
<p>Connection between these two problems are defined in this <a href="https://stats.stackexchange.com/questions/376191/why-is-the-second-derivative-required-for-newtons-method-for-back-propagation">post</a> <span class="citation">(<a href="#ref-Gulzar_2018" role="doc-biblioref">Gulzar 2018</a>)</span> very nicely.</p>
<p>Let’s pretend that we are interested in determining the parameters of a random variable <span class="math inline">\(X \sim N(\mu, \sigma^{2})\)</span>. Here is the log-likelihood function for <span class="math inline">\(X\)</span>:</p>
<p><span class="math display">\[
\log (\mathcal{L}(\mu, \sigma))=-\frac{n}{2} \log \left(2 \pi \sigma^{2}\right)-\frac{1}{2 \sigma^{2}} \sum_{i=1}^{n}\left(x_{i}-\mu\right)^{2}
\]</span></p>
<p>We have seen it in Chapter 2 before. But this time we will use <code>dnorm()</code> which calculates the pdf of a normal variable. First let’s have the data and the log-likelihood:</p>
<div class="sourceCode" id="cb1677"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1677-1"><a href="algorithmic-optimization.html#cb1677-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Let&#39;s create a sample of normal variables</span></span>
<span id="cb1677-2"><a href="algorithmic-optimization.html#cb1677-2" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">2019</span>)</span>
<span id="cb1677-3"><a href="algorithmic-optimization.html#cb1677-3" aria-hidden="true" tabindex="-1"></a>X <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(<span class="dv">100</span>, <span class="dv">0</span>, <span class="dv">1</span>)</span>
<span id="cb1677-4"><a href="algorithmic-optimization.html#cb1677-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1677-5"><a href="algorithmic-optimization.html#cb1677-5" aria-hidden="true" tabindex="-1"></a><span class="co"># And the log-likelihood of this function.</span></span>
<span id="cb1677-6"><a href="algorithmic-optimization.html#cb1677-6" aria-hidden="true" tabindex="-1"></a><span class="co"># Remember likelihood function would be prod(dnorm()) with log=F</span></span>
<span id="cb1677-7"><a href="algorithmic-optimization.html#cb1677-7" aria-hidden="true" tabindex="-1"></a>normalLL <span class="ot">&lt;-</span> <span class="cf">function</span>(prmt){</span>
<span id="cb1677-8"><a href="algorithmic-optimization.html#cb1677-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">sum</span>(<span class="fu">dnorm</span>(X, <span class="at">mean =</span> prmt[<span class="dv">1</span>], <span class="at">sd =</span> prmt[<span class="dv">2</span>], <span class="at">log =</span> <span class="cn">TRUE</span>))</span>
<span id="cb1677-9"><a href="algorithmic-optimization.html#cb1677-9" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb1677-10"><a href="algorithmic-optimization.html#cb1677-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1677-11"><a href="algorithmic-optimization.html#cb1677-11" aria-hidden="true" tabindex="-1"></a><span class="co"># Let&#39;s try several parameters</span></span>
<span id="cb1677-12"><a href="algorithmic-optimization.html#cb1677-12" aria-hidden="true" tabindex="-1"></a><span class="fu">normalLL</span>(<span class="at">prmt =</span> <span class="fu">c</span>(<span class="dv">1</span>,<span class="fl">1.5</span>))</span></code></pre></div>
<pre><code>## [1] -176.078</code></pre>
<div class="sourceCode" id="cb1679"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1679-1"><a href="algorithmic-optimization.html#cb1679-1" aria-hidden="true" tabindex="-1"></a><span class="fu">normalLL</span>(<span class="at">prmt =</span> <span class="fu">c</span>(<span class="dv">2</span>,<span class="dv">1</span>))</span></code></pre></div>
<pre><code>## [1] -347.4119</code></pre>
<div class="sourceCode" id="cb1681"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1681-1"><a href="algorithmic-optimization.html#cb1681-1" aria-hidden="true" tabindex="-1"></a><span class="fu">normalLL</span>(<span class="at">prmt =</span> <span class="fu">c</span>(<span class="fu">mean</span>(X),<span class="fu">sd</span>(X)))</span></code></pre></div>
<pre><code>## [1] -131.4619</code></pre>
<p>As you can see, the last one is the best. And we can verify it because we had created <span class="math inline">\(X\)</span> with 0 mean and 1 sd, approximately. Now we will use the Newton-Raphson method to calculate those parameters that minimize the negative log-likelihood.</p>
<p>First, let’s build a function that estimates the slope of the function (first-derivative) numerically at any arbitrary point in parameter space for mean and sd, separately. Don’t forget, <strong>the log-likelihood is a function of parameters (mean and sd) not X</strong>.</p>
<div class="sourceCode" id="cb1683"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1683-1"><a href="algorithmic-optimization.html#cb1683-1" aria-hidden="true" tabindex="-1"></a><span class="co"># First partial (numerical) derivative w.r.t. mean  </span></span>
<span id="cb1683-2"><a href="algorithmic-optimization.html#cb1683-2" aria-hidden="true" tabindex="-1"></a>firstM <span class="ot">&lt;-</span> <span class="cf">function</span>(p1, p2, <span class="at">change =</span> <span class="fl">0.0001</span>){      </span>
<span id="cb1683-3"><a href="algorithmic-optimization.html#cb1683-3" aria-hidden="true" tabindex="-1"></a>  prmt <span class="ot">&lt;-</span> <span class="fu">c</span>(p1, p2)</span>
<span id="cb1683-4"><a href="algorithmic-optimization.html#cb1683-4" aria-hidden="true" tabindex="-1"></a>  high <span class="ot">&lt;-</span> <span class="fu">normalLL</span>(prmt <span class="sc">+</span> <span class="fu">c</span>(change,<span class="dv">0</span>))</span>
<span id="cb1683-5"><a href="algorithmic-optimization.html#cb1683-5" aria-hidden="true" tabindex="-1"></a>  low <span class="ot">&lt;-</span> <span class="fu">normalLL</span>(prmt <span class="sc">-</span> <span class="fu">c</span>(change,<span class="dv">0</span>))</span>
<span id="cb1683-6"><a href="algorithmic-optimization.html#cb1683-6" aria-hidden="true" tabindex="-1"></a>  slope <span class="ot">&lt;-</span> (high<span class="sc">-</span>low)<span class="sc">/</span>(change<span class="sc">*</span><span class="dv">2</span>)</span>
<span id="cb1683-7"><a href="algorithmic-optimization.html#cb1683-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(slope)</span>
<span id="cb1683-8"><a href="algorithmic-optimization.html#cb1683-8" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb1683-9"><a href="algorithmic-optimization.html#cb1683-9" aria-hidden="true" tabindex="-1"></a><span class="fu">firstM</span>(<span class="fu">mean</span>(X), <span class="fu">sd</span>(X))</span></code></pre></div>
<pre><code>## [1] 0</code></pre>
<div class="sourceCode" id="cb1685"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1685-1"><a href="algorithmic-optimization.html#cb1685-1" aria-hidden="true" tabindex="-1"></a><span class="co"># First partial (numerical) derivative w.r.t. sd  </span></span>
<span id="cb1685-2"><a href="algorithmic-optimization.html#cb1685-2" aria-hidden="true" tabindex="-1"></a>firstSD <span class="ot">&lt;-</span> <span class="cf">function</span>(p1, p2, <span class="at">change =</span> <span class="fl">0.0001</span>){      </span>
<span id="cb1685-3"><a href="algorithmic-optimization.html#cb1685-3" aria-hidden="true" tabindex="-1"></a>  prmt <span class="ot">&lt;-</span> <span class="fu">c</span>(p1, p2)</span>
<span id="cb1685-4"><a href="algorithmic-optimization.html#cb1685-4" aria-hidden="true" tabindex="-1"></a>  high <span class="ot">&lt;-</span> <span class="fu">normalLL</span>(prmt <span class="sc">+</span> <span class="fu">c</span>(<span class="dv">0</span>, change))</span>
<span id="cb1685-5"><a href="algorithmic-optimization.html#cb1685-5" aria-hidden="true" tabindex="-1"></a>  low <span class="ot">&lt;-</span> <span class="fu">normalLL</span>(prmt <span class="sc">-</span> <span class="fu">c</span>(<span class="dv">0</span>, change))</span>
<span id="cb1685-6"><a href="algorithmic-optimization.html#cb1685-6" aria-hidden="true" tabindex="-1"></a>  slope <span class="ot">&lt;-</span> (high<span class="sc">-</span>low)<span class="sc">/</span>(change<span class="sc">*</span><span class="dv">2</span>)</span>
<span id="cb1685-7"><a href="algorithmic-optimization.html#cb1685-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(slope)</span>
<span id="cb1685-8"><a href="algorithmic-optimization.html#cb1685-8" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb1685-9"><a href="algorithmic-optimization.html#cb1685-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1685-10"><a href="algorithmic-optimization.html#cb1685-10" aria-hidden="true" tabindex="-1"></a><span class="fu">firstSD</span>(<span class="fu">mean</span>(X), <span class="fu">sd</span>(X))</span></code></pre></div>
<pre><code>## [1] -1.104417</code></pre>
<div class="sourceCode" id="cb1687"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1687-1"><a href="algorithmic-optimization.html#cb1687-1" aria-hidden="true" tabindex="-1"></a><span class="co">#Verify them with the grad()</span></span>
<span id="cb1687-2"><a href="algorithmic-optimization.html#cb1687-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(numDeriv)</span>
<span id="cb1687-3"><a href="algorithmic-optimization.html#cb1687-3" aria-hidden="true" tabindex="-1"></a>f <span class="ot">&lt;-</span> <span class="cf">function</span>(x) {</span>
<span id="cb1687-4"><a href="algorithmic-optimization.html#cb1687-4" aria-hidden="true" tabindex="-1"></a>    a <span class="ot">&lt;-</span> x[<span class="dv">1</span>]; b <span class="ot">&lt;-</span> x[<span class="dv">2</span>]  </span>
<span id="cb1687-5"><a href="algorithmic-optimization.html#cb1687-5" aria-hidden="true" tabindex="-1"></a>    <span class="fu">sum</span>(<span class="fu">dnorm</span>(X, <span class="at">mean =</span> a, <span class="at">sd =</span> b, <span class="at">log =</span> <span class="cn">TRUE</span>))</span>
<span id="cb1687-6"><a href="algorithmic-optimization.html#cb1687-6" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb1687-7"><a href="algorithmic-optimization.html#cb1687-7" aria-hidden="true" tabindex="-1"></a><span class="fu">grad</span>(f,<span class="fu">c</span>(<span class="fu">mean</span>(X),<span class="fu">sd</span>(X)))[<span class="dv">1</span>]</span></code></pre></div>
<pre><code>## [1] 0</code></pre>
<div class="sourceCode" id="cb1689"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1689-1"><a href="algorithmic-optimization.html#cb1689-1" aria-hidden="true" tabindex="-1"></a><span class="fu">grad</span>(f,<span class="fu">c</span>(<span class="fu">mean</span>(X),<span class="fu">sd</span>(X)))[<span class="dv">2</span>]</span></code></pre></div>
<pre><code>## [1] -1.104419</code></pre>
<div class="sourceCode" id="cb1691"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1691-1"><a href="algorithmic-optimization.html#cb1691-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Or better</span></span>
<span id="cb1691-2"><a href="algorithmic-optimization.html#cb1691-2" aria-hidden="true" tabindex="-1"></a><span class="fu">round</span>(<span class="fu">jacobian</span>(f,<span class="fu">c</span>(<span class="fu">mean</span>(X),<span class="fu">sd</span>(X))), <span class="dv">4</span>) <span class="co">#First derivatives</span></span></code></pre></div>
<pre><code>##      [,1]    [,2]
## [1,]    0 -1.1044</code></pre>
<div class="sourceCode" id="cb1693"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1693-1"><a href="algorithmic-optimization.html#cb1693-1" aria-hidden="true" tabindex="-1"></a><span class="fu">round</span>(<span class="fu">hessian</span>(f,<span class="fu">c</span>(<span class="fu">mean</span>(X),<span class="fu">sd</span>(X))), <span class="dv">4</span>) <span class="co">#Second derivatives</span></span></code></pre></div>
<pre><code>##           [,1]     [,2]
## [1,] -121.9741    0.000
## [2,]    0.0000 -240.289</code></pre>
<p>Let’s try them now in the Newton-Raphson method.</p>
<p><span class="math display">\[
x_{n+1}=x_{n}-\frac{g^{\prime}\left(x_{n}\right)}{g^{\prime \prime}\left(x_{n}\right)}
\]</span></p>
<p>Similar to the first one, we can also develop a function that calculates the second derivatives. However, instead of using our own functions, let’s use <code>grad()</code> and <code>hessian()</code> from the <code>numDeriv</code> package.</p>
<div class="sourceCode" id="cb1695"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1695-1"><a href="algorithmic-optimization.html#cb1695-1" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">2019</span>)</span>
<span id="cb1695-2"><a href="algorithmic-optimization.html#cb1695-2" aria-hidden="true" tabindex="-1"></a>X <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(<span class="dv">100</span>, <span class="dv">2</span>, <span class="dv">2</span>)</span>
<span id="cb1695-3"><a href="algorithmic-optimization.html#cb1695-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1695-4"><a href="algorithmic-optimization.html#cb1695-4" aria-hidden="true" tabindex="-1"></a>NR <span class="ot">&lt;-</span> <span class="cf">function</span>(f, x0, y0, <span class="at">tol =</span> <span class="fl">1e-5</span>, <span class="at">n =</span> <span class="dv">1000</span>) {</span>
<span id="cb1695-5"><a href="algorithmic-optimization.html#cb1695-5" aria-hidden="true" tabindex="-1"></a>  <span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>n) {</span>
<span id="cb1695-6"><a href="algorithmic-optimization.html#cb1695-6" aria-hidden="true" tabindex="-1"></a>    dx <span class="ot">&lt;-</span> <span class="fu">grad</span>(f,<span class="fu">c</span>(x0, y0))[<span class="dv">1</span>] <span class="co"># First-order derivative f&#39;(x0)</span></span>
<span id="cb1695-7"><a href="algorithmic-optimization.html#cb1695-7" aria-hidden="true" tabindex="-1"></a>    ddx <span class="ot">&lt;-</span> <span class="fu">hessian</span>(f,<span class="fu">c</span>(x0, y0))[<span class="dv">1</span>,<span class="dv">1</span>] <span class="co"># Second-order derivative f&#39;&#39;(x0)</span></span>
<span id="cb1695-8"><a href="algorithmic-optimization.html#cb1695-8" aria-hidden="true" tabindex="-1"></a>    x1 <span class="ot">&lt;-</span> x0 <span class="sc">-</span> (dx <span class="sc">/</span> ddx) <span class="co"># Calculate next value x1</span></span>
<span id="cb1695-9"><a href="algorithmic-optimization.html#cb1695-9" aria-hidden="true" tabindex="-1"></a>      <span class="cf">if</span> (<span class="fu">abs</span>(x1 <span class="sc">-</span> x0) <span class="sc">&lt;</span> tol) {</span>
<span id="cb1695-10"><a href="algorithmic-optimization.html#cb1695-10" aria-hidden="true" tabindex="-1"></a>        res <span class="ot">&lt;-</span> <span class="fu">paste</span>(<span class="st">&quot;The mean approximation is &quot;</span>, x1, <span class="st">&quot; in &quot;</span>, i, <span class="st">&quot; iterations&quot;</span>)</span>
<span id="cb1695-11"><a href="algorithmic-optimization.html#cb1695-11" aria-hidden="true" tabindex="-1"></a>        <span class="fu">return</span>(res)</span>
<span id="cb1695-12"><a href="algorithmic-optimization.html#cb1695-12" aria-hidden="true" tabindex="-1"></a>      }</span>
<span id="cb1695-13"><a href="algorithmic-optimization.html#cb1695-13" aria-hidden="true" tabindex="-1"></a>    <span class="co"># If Newton-Raphson has not yet reached convergence set x1 as x0 and continue</span></span>
<span id="cb1695-14"><a href="algorithmic-optimization.html#cb1695-14" aria-hidden="true" tabindex="-1"></a>    x0 <span class="ot">&lt;-</span> x1</span>
<span id="cb1695-15"><a href="algorithmic-optimization.html#cb1695-15" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb1695-16"><a href="algorithmic-optimization.html#cb1695-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">print</span>(<span class="st">&#39;Too many iterations in method&#39;</span>)</span>
<span id="cb1695-17"><a href="algorithmic-optimization.html#cb1695-17" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb1695-18"><a href="algorithmic-optimization.html#cb1695-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1695-19"><a href="algorithmic-optimization.html#cb1695-19" aria-hidden="true" tabindex="-1"></a>func <span class="ot">&lt;-</span> <span class="cf">function</span>(x) {</span>
<span id="cb1695-20"><a href="algorithmic-optimization.html#cb1695-20" aria-hidden="true" tabindex="-1"></a>    a <span class="ot">&lt;-</span> x[<span class="dv">1</span>]; b <span class="ot">&lt;-</span> x[<span class="dv">2</span>]  </span>
<span id="cb1695-21"><a href="algorithmic-optimization.html#cb1695-21" aria-hidden="true" tabindex="-1"></a>    <span class="fu">sum</span>(<span class="fu">dnorm</span>(X, <span class="at">mean =</span> a, <span class="at">sd =</span> b, <span class="at">log =</span> <span class="cn">TRUE</span>))</span>
<span id="cb1695-22"><a href="algorithmic-optimization.html#cb1695-22" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb1695-23"><a href="algorithmic-optimization.html#cb1695-23" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1695-24"><a href="algorithmic-optimization.html#cb1695-24" aria-hidden="true" tabindex="-1"></a><span class="fu">NR</span>(func, <span class="sc">-</span><span class="dv">3</span>, <span class="fl">1.5</span>)</span></code></pre></div>
<pre><code>## [1] &quot;The mean approximation is  1.85333200308383  in  2  iterations&quot;</code></pre>
<div class="sourceCode" id="cb1697"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1697-1"><a href="algorithmic-optimization.html#cb1697-1" aria-hidden="true" tabindex="-1"></a><span class="co">#Let;s verify it</span></span>
<span id="cb1697-2"><a href="algorithmic-optimization.html#cb1697-2" aria-hidden="true" tabindex="-1"></a><span class="fu">mean</span>(X)</span></code></pre></div>
<pre><code>## [1] 1.853332</code></pre>
<p>Finding sd is left to the practice questions. But the way to do it should be obvious. Use our approximation of the mean (1.853332) as a fixed parameter in the function and run the same algorithm for finding sd. <strong>When the power of computers and the genius of mathematics intercepts, beautiful magics happen</strong>.</p>
</div>
<div id="ml-estimation-with-logistic-regression" class="section level2 hasAnchor" number="42.3">
<h2><span class="header-section-number">42.3</span> ML Estimation with logistic regression<a href="algorithmic-optimization.html#ml-estimation-with-logistic-regression" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>The pdf of Bernoulli distribution is</p>
<p><span class="math display">\[
P(Y=y)=p^y(1-p)^{1-y}
\]</span>
It’s likelihood</p>
<p><span class="math display">\[
\begin{aligned}
L(\boldsymbol{\beta} \mid \mathbf{y} ; \mathbf{x}) &amp;=L\left(\beta_0, \beta_1 \mid\left(y_1, \ldots, y_n\right) ;\left(x_1, \ldots, x_n\right)\right) \\
&amp;=\prod_{i=1}^n p_i^{y_i}\left(1-p_i\right)^{1-y_i}
\end{aligned}
\]</span>
And log-likelihood</p>
<p><span class="math display">\[
\begin{aligned}
\ell(\boldsymbol{\beta} \mid \mathbf{y} ; \mathbf{x}) &amp;=\log \left(\prod_{i=1}^n p_i^{y_i}\left(1-p_i\right)^{1-y_i}\right) \\
&amp;=\sum_{i=1}^n \log \left(p_i^{y_i}\right)+\log \left(\left(1-p_i\right)^{1-y_i}\right) \\
&amp;=\sum_{i=1}^n y_i \log \left(p_i\right)+\left(1-y_i\right) \log \left(1-p_i\right)
\end{aligned}
\]</span>
where</p>
<p><span class="math display">\[
\begin{aligned}
\operatorname{logit}\left(p_i\right) &amp;=\log \left(\frac{p_i}{1-p_i}\right) \\
&amp;=\beta_0+\beta_1 x_1
\end{aligned}
\]</span></p>
<p>So,</p>
<p><span class="math display">\[
p_i=\frac{\exp \left(\beta_0+x_1 \beta_1\right)}{1+\exp \left(\beta_0+x_1 \beta_1\right)}
\]</span>
First partial derivative with respect to <span class="math inline">\(\beta_0\)</span>
<span class="math display">\[
\begin{aligned}
\frac{\partial p_i}{\partial \beta_0} &amp;=\frac{\exp \left(\beta_0+x_1 \beta_1\right)}{\left(1+\exp \left(\beta_0+x_1 \beta_1\right)\right)^2} \\
&amp;=p_i\left(1-p_i\right)
\end{aligned}
\]</span>
And</p>
<p><span class="math display">\[
\begin{aligned}
\frac{\partial p_i}{\partial \beta_1} &amp;=\frac{x_1 \exp \left(\beta_0+x_1 \beta_1\right)}{\left(1+\exp \left(\beta_0+x_1 \beta_1\right)\right)^2} \\
&amp;=x_1 p_i\left(1-p_i\right)
\end{aligned}
\]</span>
Newton-Raphson’s equation is</p>
<p><span class="math display">\[
\boldsymbol{\beta}^{(t+1)}=\boldsymbol{\beta}^{(t)}-\left(\boldsymbol{H}^{(t)}\right)^{-1} \boldsymbol{u}^{(t)},
\]</span></p>
<p>where</p>
<p><span class="math display">\[
\boldsymbol{\beta}^{(t)}=\left[\begin{array}{c}
\beta_0^{(t)} \\
\beta_1^{(t)}
\end{array}\right]
\]</span></p>
<p><span class="math display">\[
\boldsymbol{u}^{(t)}=\left[\begin{array}{c}
u_0^{(t)} \\
u_1^{(t)}
\end{array}\right]=\left[\begin{array}{c}
\frac{\partial \mathcal{C}\left(\beta^{(t)} \mid y ; x\right)}{\partial \beta_0} \\
\frac{\partial \mathscr{C}\left(\beta^{(t)} \mid y ; x\right)}{\partial \beta_1}
\end{array}\right]=\left[\begin{array}{c}
\sum_{i=1}^n y_i-p_i^{(t)} \\
\sum_{i=1}^n x_i\left(y_i-p_i^{(t)}\right)
\end{array}\right]
\]</span>
<span class="math display">\[
p_i^{(t)}=\frac{\exp \left(\beta_0^{(t)}+x_1 \beta_1^{(0)}\right)}{1+\exp \left(\beta_0^{(t)}+x_1 \beta_1^{(t)}\right)}
\]</span></p>
<p><span class="math inline">\(\boldsymbol{H}^{(t)}\)</span> can be considered as Jacobian matrix of <span class="math inline">\(\boldsymbol{u}(\cdot)\)</span>,</p>
<p><span class="math display">\[
\boldsymbol{H}^{(t)}=\left[\begin{array}{ll}
\frac{\partial u_0^{(t)}}{\partial \beta_0} &amp; \frac{\partial u_0^{(t)}}{\partial \beta_1} \\
\frac{\partial u_1^{(t)}}{\partial \beta_0} &amp; \frac{\partial u_1^{(t)}}{\partial \beta_1}
\end{array}\right]
\]</span></p>
<div class="sourceCode" id="cb1699"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1699-1"><a href="algorithmic-optimization.html#cb1699-1" aria-hidden="true" tabindex="-1"></a><span class="fu">rm</span>(<span class="at">list=</span><span class="fu">ls</span>())</span>
<span id="cb1699-2"><a href="algorithmic-optimization.html#cb1699-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1699-3"><a href="algorithmic-optimization.html#cb1699-3" aria-hidden="true" tabindex="-1"></a><span class="co">#Creating random data</span></span>
<span id="cb1699-4"><a href="algorithmic-optimization.html#cb1699-4" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">1</span>) </span>
<span id="cb1699-5"><a href="algorithmic-optimization.html#cb1699-5" aria-hidden="true" tabindex="-1"></a>n <span class="ot">&lt;-</span> <span class="dv">500</span> </span>
<span id="cb1699-6"><a href="algorithmic-optimization.html#cb1699-6" aria-hidden="true" tabindex="-1"></a>xx <span class="ot">=</span> <span class="fu">rnorm</span>(n) <span class="co"># this is our x</span></span>
<span id="cb1699-7"><a href="algorithmic-optimization.html#cb1699-7" aria-hidden="true" tabindex="-1"></a>z <span class="ot">=</span> <span class="sc">-</span><span class="dv">2</span> <span class="sc">+</span> <span class="dv">3</span> <span class="sc">*</span> xx</span>
<span id="cb1699-8"><a href="algorithmic-optimization.html#cb1699-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1699-9"><a href="algorithmic-optimization.html#cb1699-9" aria-hidden="true" tabindex="-1"></a><span class="co">#Probability is defined by a logistic function</span></span>
<span id="cb1699-10"><a href="algorithmic-optimization.html#cb1699-10" aria-hidden="true" tabindex="-1"></a>p <span class="ot">=</span> <span class="dv">1</span> <span class="sc">/</span> (<span class="dv">1</span> <span class="sc">+</span> <span class="fu">exp</span>(<span class="sc">-</span>z))</span>
<span id="cb1699-11"><a href="algorithmic-optimization.html#cb1699-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1699-12"><a href="algorithmic-optimization.html#cb1699-12" aria-hidden="true" tabindex="-1"></a><span class="co">#Bernoulli is the special case of the binomial distribution with size = 1</span></span>
<span id="cb1699-13"><a href="algorithmic-optimization.html#cb1699-13" aria-hidden="true" tabindex="-1"></a>y <span class="ot">=</span> <span class="fu">rbinom</span>(n, <span class="at">size =</span> <span class="dv">1</span>, <span class="at">prob =</span> p)</span>
<span id="cb1699-14"><a href="algorithmic-optimization.html#cb1699-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1699-15"><a href="algorithmic-optimization.html#cb1699-15" aria-hidden="true" tabindex="-1"></a><span class="co">#And we create our data</span></span>
<span id="cb1699-16"><a href="algorithmic-optimization.html#cb1699-16" aria-hidden="true" tabindex="-1"></a>df1 <span class="ot">&lt;-</span>  <span class="fu">data.frame</span>(y, xx)</span>
<span id="cb1699-17"><a href="algorithmic-optimization.html#cb1699-17" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(df1)</span></code></pre></div>
<pre><code>##   y         xx
## 1 0 -0.6264538
## 2 0  0.1836433
## 3 0 -0.8356286
## 4 0  1.5952808
## 5 0  0.3295078
## 6 0 -0.8204684</code></pre>
<div class="sourceCode" id="cb1701"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1701-1"><a href="algorithmic-optimization.html#cb1701-1" aria-hidden="true" tabindex="-1"></a>logis <span class="ot">&lt;-</span> <span class="fu">glm</span>(y <span class="sc">~</span> xx, <span class="at">data =</span> df1, <span class="at">family =</span> binomial)</span>
<span id="cb1701-2"><a href="algorithmic-optimization.html#cb1701-2" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(logis)</span></code></pre></div>
<pre><code>## 
## Call:
## glm(formula = y ~ xx, family = binomial, data = df1)
## 
## Deviance Residuals: 
##     Min       1Q   Median       3Q      Max  
## -2.3813  -0.4785  -0.2096   0.2988   2.4274  
## 
## Coefficients:
##             Estimate Std. Error z value Pr(&gt;|z|)    
## (Intercept)  -1.8253     0.1867  -9.776   &lt;2e-16 ***
## xx            2.7809     0.2615  10.635   &lt;2e-16 ***
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## (Dispersion parameter for binomial family taken to be 1)
## 
##     Null deviance: 605.69  on 499  degrees of freedom
## Residual deviance: 328.13  on 498  degrees of freedom
## AIC: 332.13
## 
## Number of Fisher Scoring iterations: 6</code></pre>
<div class="sourceCode" id="cb1703"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1703-1"><a href="algorithmic-optimization.html#cb1703-1" aria-hidden="true" tabindex="-1"></a>func.u <span class="ot">&lt;-</span> <span class="cf">function</span>(x) <span class="fu">c</span>(<span class="fu">sum</span>(df1<span class="sc">$</span>y <span class="sc">-</span> <span class="fu">exp</span>(x[<span class="dv">1</span>] <span class="sc">+</span> x[<span class="dv">2</span>] <span class="sc">*</span> df1<span class="sc">$</span>xx)<span class="sc">/</span> (<span class="dv">1</span> <span class="sc">+</span> <span class="fu">exp</span>(x[<span class="dv">1</span>] <span class="sc">+</span> x[<span class="dv">2</span>] <span class="sc">*</span> df1<span class="sc">$</span>xx))),</span>
<span id="cb1703-2"><a href="algorithmic-optimization.html#cb1703-2" aria-hidden="true" tabindex="-1"></a>                        <span class="fu">sum</span>(df1<span class="sc">$</span>xx <span class="sc">*</span> (df1<span class="sc">$</span>y <span class="sc">-</span> <span class="fu">exp</span>(x[<span class="dv">1</span>] <span class="sc">+</span> x[<span class="dv">2</span>] <span class="sc">*</span> df1<span class="sc">$</span>xx)<span class="sc">/</span> (<span class="dv">1</span> <span class="sc">+</span> <span class="fu">exp</span>(x[<span class="dv">1</span>] <span class="sc">+</span> x[<span class="dv">2</span>] <span class="sc">*</span> df1<span class="sc">$</span>xx)))))</span>
<span id="cb1703-3"><a href="algorithmic-optimization.html#cb1703-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1703-4"><a href="algorithmic-optimization.html#cb1703-4" aria-hidden="true" tabindex="-1"></a>delta <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">2</span>,<span class="at">nrow =</span> <span class="dv">2</span>)</span>
<span id="cb1703-5"><a href="algorithmic-optimization.html#cb1703-5" aria-hidden="true" tabindex="-1"></a>x <span class="ot">&lt;-</span> <span class="fu">array</span>(<span class="fu">c</span>(<span class="sc">-</span><span class="dv">2</span>,<span class="dv">3</span>))</span>
<span id="cb1703-6"><a href="algorithmic-optimization.html#cb1703-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1703-7"><a href="algorithmic-optimization.html#cb1703-7" aria-hidden="true" tabindex="-1"></a><span class="cf">while</span>(<span class="fu">abs</span>(<span class="fu">sum</span>(delta)) <span class="sc">&gt;</span> <span class="fl">0.0001</span>){</span>
<span id="cb1703-8"><a href="algorithmic-optimization.html#cb1703-8" aria-hidden="true" tabindex="-1"></a>  xx <span class="ot">&lt;-</span> x <span class="do">##current x value</span></span>
<span id="cb1703-9"><a href="algorithmic-optimization.html#cb1703-9" aria-hidden="true" tabindex="-1"></a>  x <span class="ot">&lt;-</span> <span class="fu">as.matrix</span>(x) <span class="sc">-</span> <span class="fu">solve</span>(<span class="fu">jacobian</span>(func.u, <span class="at">x =</span> x)) <span class="sc">%*%</span> <span class="fu">func.u</span>(x) <span class="do">##new x value</span></span>
<span id="cb1703-10"><a href="algorithmic-optimization.html#cb1703-10" aria-hidden="true" tabindex="-1"></a>  delta <span class="ot">&lt;-</span> x <span class="sc">-</span> <span class="fu">as.matrix</span>(xx)</span>
<span id="cb1703-11"><a href="algorithmic-optimization.html#cb1703-11" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb1703-12"><a href="algorithmic-optimization.html#cb1703-12" aria-hidden="true" tabindex="-1"></a>x</span></code></pre></div>
<pre><code>##           [,1]
## [1,] -1.825347
## [2,]  2.780929</code></pre>
</div>
<div id="gradient-descent-algorithm" class="section level2 hasAnchor" number="42.4">
<h2><span class="header-section-number">42.4</span> Gradient Descent Algorithm<a href="algorithmic-optimization.html#gradient-descent-algorithm" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>Let’s start with a regression problem. The cost function in OLS is the residual sum of squares, <span class="math inline">\(\mathrm{RSS}=\sum_{i=1}^n\left(\widehat{e}_i\right)^2=\sum_{i=1}^n\left(y_i-\hat{y}\right)^2=\sum_{i=1}^n\left(y_i-\left(b_1+b_2 x_i\right)\right)^2\)</span>, which is a convex function. Our objective to find <span class="math inline">\(b_1\)</span> and <span class="math inline">\(b_2\)</span> that minimize RSS. How can we find those parameters to minimize a cost function if we don’t know much about it? The trick is to start with some point and move a bit (locally) in the direction that reduces the value of the cost function. In general, this search process for finding the minimizing point has two components: the direction and the step size. The direction tells us which direction we move next, and the step size determines how far we move in that direction. For example, the iterative search for <span class="math inline">\(b_2\)</span> of gradient descent can be described by the following recursive rule:</p>
<p><span class="math display">\[
b_2^{(k+1)}=b_2^{(k)}-lr \nabla RSS^{k}
\]</span>
Here, <span class="math inline">\(lr\)</span> is <em>learning rate</em> and <span class="math inline">\(\nabla RSS^{k}\)</span> is the slope of RSS at step <span class="math inline">\(k\)</span>. Hence, <span class="math inline">\(lr \nabla RSS^{k}\)</span> is the total step size at step <span class="math inline">\(k\)</span>. Note that, as we move from either directions towards <span class="math inline">\(b^*_2\)</span>, <span class="math inline">\(\nabla RSS^{k}\)</span> gets smaller. In fact, it becomes zero at <span class="math inline">\(b^*_2\)</span>. Therefore, <span class="math inline">\(\nabla RSS^{k}\)</span> helps iterations find the proper adjustment in each step in terms of direction and magnitude. Since RSS is a convex function, it’s easy to see how sign of <span class="math inline">\(\nabla RSS^{k}\)</span> will direct the arbitrary <span class="math inline">\(b_2^{&#39;&#39;}\)</span> towards the optimal <span class="math inline">\(b_2\)</span>.</p>
<p><img src="png/gradient.png" width="65%" height="60%" /></p>
<p>Since first-order approximation at <span class="math inline">\(b_2^{&#39;&#39;}\)</span> is good only for small <span class="math inline">\(\Delta b_2\)</span>, a small <span class="math inline">\(lr&gt;0\)</span> is needed to o make <span class="math inline">\(\Delta b_2\)</span> small in magnitude. Moreover, when a high learning rate used it leads to “overshooting” past the local minima and may result in diverging algorithm.</p>
<p>Below, we first use a simple linear regression function on simulated data and estimate its parameters with <code>lm()</code>. Let’s simulate a sample with our DGM.</p>
<div class="sourceCode" id="cb1705"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1705-1"><a href="algorithmic-optimization.html#cb1705-1" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">1001</span>)</span>
<span id="cb1705-2"><a href="algorithmic-optimization.html#cb1705-2" aria-hidden="true" tabindex="-1"></a>N <span class="ot">&lt;-</span> <span class="dv">100</span></span>
<span id="cb1705-3"><a href="algorithmic-optimization.html#cb1705-3" aria-hidden="true" tabindex="-1"></a>int <span class="ot">&lt;-</span> <span class="fu">rep</span>(<span class="dv">1</span>, N)</span>
<span id="cb1705-4"><a href="algorithmic-optimization.html#cb1705-4" aria-hidden="true" tabindex="-1"></a>x1 <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(N, <span class="at">mean =</span> <span class="dv">10</span>, <span class="at">sd =</span> <span class="dv">2</span>)</span>
<span id="cb1705-5"><a href="algorithmic-optimization.html#cb1705-5" aria-hidden="true" tabindex="-1"></a>Y <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(N, <span class="dv">2</span><span class="sc">*</span>x1 <span class="sc">+</span> int, <span class="dv">1</span>)</span>
<span id="cb1705-6"><a href="algorithmic-optimization.html#cb1705-6" aria-hidden="true" tabindex="-1"></a>model <span class="ot">&lt;-</span> <span class="fu">lm</span>(Y <span class="sc">~</span> x1)</span>
<span id="cb1705-7"><a href="algorithmic-optimization.html#cb1705-7" aria-hidden="true" tabindex="-1"></a>b <span class="ot">&lt;-</span> <span class="fu">coef</span>(model)</span>
<span id="cb1705-8"><a href="algorithmic-optimization.html#cb1705-8" aria-hidden="true" tabindex="-1"></a>b</span></code></pre></div>
<pre><code>## (Intercept)          x1 
##    1.209597    1.979643</code></pre>
<div class="sourceCode" id="cb1707"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1707-1"><a href="algorithmic-optimization.html#cb1707-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(x1, Y, <span class="at">col =</span> <span class="st">&quot;blue&quot;</span>, <span class="at">pch =</span> <span class="dv">20</span>)</span>
<span id="cb1707-2"><a href="algorithmic-optimization.html#cb1707-2" aria-hidden="true" tabindex="-1"></a><span class="fu">abline</span>(b)</span></code></pre></div>
<p><img src="YA_TextBook_files/figure-html/unnamed-chunk-514-1.png" width="672" /></p>
<div id="one-variable" class="section level3 hasAnchor" number="42.4.1">
<h3><span class="header-section-number">42.4.1</span> One-variable<a href="algorithmic-optimization.html#one-variable" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Below, we create a function, <code>gradientDesc,</code> to show how sensitive gradient descent algorithms would be to different calibrations:</p>
<div class="sourceCode" id="cb1708"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1708-1"><a href="algorithmic-optimization.html#cb1708-1" aria-hidden="true" tabindex="-1"></a>gradientDesc <span class="ot">&lt;-</span> <span class="cf">function</span>(x, y, learnrate, conthresh, maxiter) {</span>
<span id="cb1708-2"><a href="algorithmic-optimization.html#cb1708-2" aria-hidden="true" tabindex="-1"></a>  <span class="co">#starting points</span></span>
<span id="cb1708-3"><a href="algorithmic-optimization.html#cb1708-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">set.seed</span>(<span class="dv">234</span>)</span>
<span id="cb1708-4"><a href="algorithmic-optimization.html#cb1708-4" aria-hidden="true" tabindex="-1"></a>  b <span class="ot">&lt;-</span> <span class="fu">runif</span>(<span class="dv">1</span>, <span class="dv">0</span>, <span class="dv">1</span>)</span>
<span id="cb1708-5"><a href="algorithmic-optimization.html#cb1708-5" aria-hidden="true" tabindex="-1"></a>  c <span class="ot">&lt;-</span> <span class="fu">runif</span>(<span class="dv">1</span>, <span class="dv">0</span>, <span class="dv">1</span>)</span>
<span id="cb1708-6"><a href="algorithmic-optimization.html#cb1708-6" aria-hidden="true" tabindex="-1"></a>  n <span class="ot">&lt;-</span> <span class="fu">length</span>(x)</span>
<span id="cb1708-7"><a href="algorithmic-optimization.html#cb1708-7" aria-hidden="true" tabindex="-1"></a>  <span class="co">#function</span></span>
<span id="cb1708-8"><a href="algorithmic-optimization.html#cb1708-8" aria-hidden="true" tabindex="-1"></a>  yhat <span class="ot">&lt;-</span> b <span class="sc">*</span> x <span class="sc">+</span> c</span>
<span id="cb1708-9"><a href="algorithmic-optimization.html#cb1708-9" aria-hidden="true" tabindex="-1"></a>  <span class="co">#gradient</span></span>
<span id="cb1708-10"><a href="algorithmic-optimization.html#cb1708-10" aria-hidden="true" tabindex="-1"></a>  MSE <span class="ot">&lt;-</span> <span class="fu">sum</span>((y <span class="sc">-</span> yhat) <span class="sc">^</span> <span class="dv">2</span>) <span class="sc">/</span> n</span>
<span id="cb1708-11"><a href="algorithmic-optimization.html#cb1708-11" aria-hidden="true" tabindex="-1"></a>  converged <span class="ot">=</span> F</span>
<span id="cb1708-12"><a href="algorithmic-optimization.html#cb1708-12" aria-hidden="true" tabindex="-1"></a>  iterations <span class="ot">=</span> <span class="dv">0</span></span>
<span id="cb1708-13"><a href="algorithmic-optimization.html#cb1708-13" aria-hidden="true" tabindex="-1"></a>  <span class="co">#while loop</span></span>
<span id="cb1708-14"><a href="algorithmic-optimization.html#cb1708-14" aria-hidden="true" tabindex="-1"></a>  <span class="cf">while</span> (converged <span class="sc">==</span> F) {</span>
<span id="cb1708-15"><a href="algorithmic-optimization.html#cb1708-15" aria-hidden="true" tabindex="-1"></a>    b_new <span class="ot">&lt;-</span> b <span class="sc">+</span> learnrate <span class="sc">*</span> (<span class="dv">1</span> <span class="sc">/</span> n) <span class="sc">*</span> (<span class="fu">sum</span>((y <span class="sc">-</span> yhat) <span class="sc">*</span> x))</span>
<span id="cb1708-16"><a href="algorithmic-optimization.html#cb1708-16" aria-hidden="true" tabindex="-1"></a>    c_new <span class="ot">&lt;-</span> c <span class="sc">+</span> learnrate <span class="sc">*</span> (<span class="dv">1</span> <span class="sc">/</span> n) <span class="sc">*</span> (<span class="fu">sum</span>(y <span class="sc">-</span> yhat))</span>
<span id="cb1708-17"><a href="algorithmic-optimization.html#cb1708-17" aria-hidden="true" tabindex="-1"></a>    b <span class="ot">&lt;-</span> b_new</span>
<span id="cb1708-18"><a href="algorithmic-optimization.html#cb1708-18" aria-hidden="true" tabindex="-1"></a>    c <span class="ot">&lt;-</span> c_new</span>
<span id="cb1708-19"><a href="algorithmic-optimization.html#cb1708-19" aria-hidden="true" tabindex="-1"></a>    yhat <span class="ot">&lt;-</span> b <span class="sc">*</span> x <span class="sc">+</span> c</span>
<span id="cb1708-20"><a href="algorithmic-optimization.html#cb1708-20" aria-hidden="true" tabindex="-1"></a>    MSE_new <span class="ot">&lt;-</span> <span class="fu">sum</span>((y <span class="sc">-</span> yhat) <span class="sc">^</span> <span class="dv">2</span>) <span class="sc">/</span> n</span>
<span id="cb1708-21"><a href="algorithmic-optimization.html#cb1708-21" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> (<span class="fu">abs</span>(MSE <span class="sc">-</span> MSE_new) <span class="sc">&lt;=</span> conthresh) {</span>
<span id="cb1708-22"><a href="algorithmic-optimization.html#cb1708-22" aria-hidden="true" tabindex="-1"></a>      converged <span class="ot">=</span> T</span>
<span id="cb1708-23"><a href="algorithmic-optimization.html#cb1708-23" aria-hidden="true" tabindex="-1"></a>      <span class="fu">return</span>(<span class="fu">paste</span>(<span class="st">&quot;Intercept:&quot;</span>, c, <span class="st">&quot;Slope:&quot;</span>, b))</span>
<span id="cb1708-24"><a href="algorithmic-optimization.html#cb1708-24" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb1708-25"><a href="algorithmic-optimization.html#cb1708-25" aria-hidden="true" tabindex="-1"></a>    iterations <span class="ot">=</span> iterations <span class="sc">+</span> <span class="dv">1</span></span>
<span id="cb1708-26"><a href="algorithmic-optimization.html#cb1708-26" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> (iterations <span class="sc">&gt;</span> maxiter) {</span>
<span id="cb1708-27"><a href="algorithmic-optimization.html#cb1708-27" aria-hidden="true" tabindex="-1"></a>      converged <span class="ot">=</span> T</span>
<span id="cb1708-28"><a href="algorithmic-optimization.html#cb1708-28" aria-hidden="true" tabindex="-1"></a>      <span class="fu">return</span>(<span class="fu">paste</span>(<span class="st">&quot;Max. iter. reached, &quot;</span>, <span class="st">&quot;Intercept:&quot;</span>,</span>
<span id="cb1708-29"><a href="algorithmic-optimization.html#cb1708-29" aria-hidden="true" tabindex="-1"></a>                   c, <span class="st">&quot;Slope:&quot;</span>, b))</span>
<span id="cb1708-30"><a href="algorithmic-optimization.html#cb1708-30" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb1708-31"><a href="algorithmic-optimization.html#cb1708-31" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb1708-32"><a href="algorithmic-optimization.html#cb1708-32" aria-hidden="true" tabindex="-1"></a>}</span></code></pre></div>
<p>Note that the key part in this algorithm is <code>b_new &lt;- b + learnrate * (1 / n) * (sum((y - yhat) * x))</code>.
The first <span class="math inline">\(b\)</span> that is picked randomly by <code>b &lt;- runif(1, 0, 1)</code> is adjusted by <code>learnrate * (1 / n) * (sum((y - yhat) * x))</code>.</p>
<p>Note that <code>sum((y - yhat) * x)</code> is one of the f.o.c of the cost function (RSS - Residual Sum of Squares) or the “normal” equation for the slope coefficient. The cost function (RSS) is a convex function where the minimum can be achieved by the optimal <span class="math inline">\(b\)</span>. It is a linear Taylor approximation of RSS at <span class="math inline">\(b\)</span> that provides the <strong>steepest</strong> descent, that is just a simple adjustment for identifying the direction of the adjustment of <span class="math inline">\(b\)</span> until the minimum RSS is reached.</p>
<p>Now we will see if this function will give us the same intercept and slope coefficients already calculated with <code>lm()</code> above.</p>
<div class="sourceCode" id="cb1709"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1709-1"><a href="algorithmic-optimization.html#cb1709-1" aria-hidden="true" tabindex="-1"></a><span class="fu">gradientDesc</span>(x1, Y, <span class="fl">0.000293</span>, <span class="fl">0.001</span>, <span class="dv">2500000</span>) <span class="co"># Perfect</span></span></code></pre></div>
<pre><code>## [1] &quot;Max. iter. reached,  Intercept: 1.20959654028224 Slope: 1.97964316494781&quot;</code></pre>
<div class="sourceCode" id="cb1711"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1711-1"><a href="algorithmic-optimization.html#cb1711-1" aria-hidden="true" tabindex="-1"></a><span class="fu">gradientDesc</span>(x1, Y, <span class="fl">0.0000293</span>, <span class="fl">0.001</span>, <span class="dv">2500000</span>) <span class="co"># Ehhhh</span></span></code></pre></div>
<pre><code>## [1] &quot;Max. iter. reached,  Intercept: 1.20102677446618 Slope: 1.980458385393&quot;</code></pre>
<div class="sourceCode" id="cb1713"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1713-1"><a href="algorithmic-optimization.html#cb1713-1" aria-hidden="true" tabindex="-1"></a><span class="fu">gradientDesc</span>(x1, Y, <span class="fl">0.00000293</span>, <span class="fl">0.001</span>, <span class="dv">2500000</span>) <span class="co"># Too little</span></span></code></pre></div>
<pre><code>## [1] &quot;Max. iter. reached,  Intercept: 0.994504430596522 Slope: 2.00010434080475&quot;</code></pre>
<div class="sourceCode" id="cb1715"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1715-1"><a href="algorithmic-optimization.html#cb1715-1" aria-hidden="true" tabindex="-1"></a><span class="fu">gradientDesc</span>(x1, Y, <span class="fl">0.000293</span>, <span class="fl">0.001</span>, <span class="dv">2500000</span>) <span class="co"># Perfect</span></span></code></pre></div>
<pre><code>## [1] &quot;Max. iter. reached,  Intercept: 1.20959654028224 Slope: 1.97964316494781&quot;</code></pre>
<div class="sourceCode" id="cb1717"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1717-1"><a href="algorithmic-optimization.html#cb1717-1" aria-hidden="true" tabindex="-1"></a><span class="fu">gradientDesc</span>(x1, Y, <span class="fl">0.00293</span>, <span class="fl">0.001</span>, <span class="dv">2500000</span>) <span class="co"># perfect</span></span></code></pre></div>
<pre><code>## [1] &quot;Max. iter. reached,  Intercept: 1.2095965402898 Slope: 1.97964316494709&quot;</code></pre>
<p>Yes, the main question is how do we find out what the learning rate should be? It is an active research question and to answer it is beyond this chapter. A general suggestion, however, is to keep it small and tune it within the training process.</p>
</div>
<div id="multivariable" class="section level3 hasAnchor" number="42.4.2">
<h3><span class="header-section-number">42.4.2</span> Multivariable<a href="algorithmic-optimization.html#multivariable" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>We will expand the gradient descent algorithms with an multivariable example using matrix algebra. First, the data and model simulation:</p>
<div class="sourceCode" id="cb1719"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1719-1"><a href="algorithmic-optimization.html#cb1719-1" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">1001</span>)</span>
<span id="cb1719-2"><a href="algorithmic-optimization.html#cb1719-2" aria-hidden="true" tabindex="-1"></a>N <span class="ot">&lt;-</span> <span class="dv">100</span></span>
<span id="cb1719-3"><a href="algorithmic-optimization.html#cb1719-3" aria-hidden="true" tabindex="-1"></a>int <span class="ot">&lt;-</span> <span class="fu">rep</span>(<span class="dv">1</span>, N)</span>
<span id="cb1719-4"><a href="algorithmic-optimization.html#cb1719-4" aria-hidden="true" tabindex="-1"></a>x1 <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(N, <span class="at">mean =</span> <span class="dv">10</span>, <span class="at">sd =</span> <span class="dv">2</span>)</span>
<span id="cb1719-5"><a href="algorithmic-optimization.html#cb1719-5" aria-hidden="true" tabindex="-1"></a>x2 <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(N, <span class="at">mean =</span> <span class="dv">5</span>, <span class="at">sd =</span> <span class="dv">1</span>)</span>
<span id="cb1719-6"><a href="algorithmic-optimization.html#cb1719-6" aria-hidden="true" tabindex="-1"></a>x3 <span class="ot">&lt;-</span> <span class="fu">rbinom</span>(N, <span class="dv">1</span>, <span class="fl">0.5</span>)</span>
<span id="cb1719-7"><a href="algorithmic-optimization.html#cb1719-7" aria-hidden="true" tabindex="-1"></a>x4 <span class="ot">&lt;-</span> <span class="fu">rbinom</span>(N, <span class="dv">1</span>, <span class="fl">0.5</span>)</span>
<span id="cb1719-8"><a href="algorithmic-optimization.html#cb1719-8" aria-hidden="true" tabindex="-1"></a>x5 <span class="ot">&lt;-</span> <span class="fu">rbinom</span>(N, <span class="dv">1</span>, <span class="fl">0.5</span>)</span>
<span id="cb1719-9"><a href="algorithmic-optimization.html#cb1719-9" aria-hidden="true" tabindex="-1"></a>x6 <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(N, <span class="dv">1</span>, <span class="fl">0.25</span>)</span>
<span id="cb1719-10"><a href="algorithmic-optimization.html#cb1719-10" aria-hidden="true" tabindex="-1"></a>x7 <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(N, <span class="dv">1</span>, <span class="fl">0.2</span>)</span>
<span id="cb1719-11"><a href="algorithmic-optimization.html#cb1719-11" aria-hidden="true" tabindex="-1"></a>x2x3 <span class="ot">&lt;-</span> x2<span class="sc">*</span>x3</span>
<span id="cb1719-12"><a href="algorithmic-optimization.html#cb1719-12" aria-hidden="true" tabindex="-1"></a>x4x5 <span class="ot">&lt;-</span> x4<span class="sc">*</span>x5</span>
<span id="cb1719-13"><a href="algorithmic-optimization.html#cb1719-13" aria-hidden="true" tabindex="-1"></a>x4x6 <span class="ot">&lt;-</span> x5<span class="sc">*</span>x6</span>
<span id="cb1719-14"><a href="algorithmic-optimization.html#cb1719-14" aria-hidden="true" tabindex="-1"></a>x3x7 <span class="ot">&lt;-</span> x3<span class="sc">*</span>x7</span>
<span id="cb1719-15"><a href="algorithmic-optimization.html#cb1719-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1719-16"><a href="algorithmic-optimization.html#cb1719-16" aria-hidden="true" tabindex="-1"></a>Y <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(N, <span class="dv">2</span><span class="sc">*</span>x1 <span class="sc">+</span> <span class="sc">-</span><span class="fl">0.5</span><span class="sc">*</span>x2 <span class="sc">-</span> <span class="fl">1.75</span><span class="sc">*</span>x2x3 <span class="sc">+</span> <span class="dv">2</span><span class="sc">*</span>x4x5 <span class="sc">-</span> <span class="dv">3</span><span class="sc">*</span>x4x6 <span class="sc">+</span> <span class="fl">1.2</span><span class="sc">*</span>x3x7 <span class="sc">+</span> int, <span class="dv">1</span>)</span>
<span id="cb1719-17"><a href="algorithmic-optimization.html#cb1719-17" aria-hidden="true" tabindex="-1"></a>X <span class="ot">&lt;-</span> <span class="fu">cbind</span>(int, x1, x2, x2x3, x4x5, x4x6, x3x7)</span></code></pre></div>
<p>We can solve it with linear algebra manually:</p>
<div class="sourceCode" id="cb1720"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1720-1"><a href="algorithmic-optimization.html#cb1720-1" aria-hidden="true" tabindex="-1"></a>betaOLS <span class="ot">&lt;-</span> <span class="fu">solve</span>(<span class="fu">t</span>(X)<span class="sc">%*%</span>X)<span class="sc">%*%</span><span class="fu">t</span>(X)<span class="sc">%*%</span>Y</span>
<span id="cb1720-2"><a href="algorithmic-optimization.html#cb1720-2" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(betaOLS)</span></code></pre></div>
<pre><code>##            [,1]
## int   0.4953323
## x1    1.9559022
## x2   -0.3511182
## x2x3 -1.9112623
## x4x5  1.7424723
## x4x6 -2.8323934
## x3x7  2.1015442</code></pre>
<p>We can also solve it with <code>lm()</code></p>
<div class="sourceCode" id="cb1722"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1722-1"><a href="algorithmic-optimization.html#cb1722-1" aria-hidden="true" tabindex="-1"></a>model1.lm <span class="ot">&lt;-</span> <span class="fu">lm</span>(Y <span class="sc">~</span> X <span class="sc">-</span><span class="dv">1</span>)</span>
<span id="cb1722-2"><a href="algorithmic-optimization.html#cb1722-2" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(model1.lm)</span></code></pre></div>
<pre><code>## 
## Call:
## lm(formula = Y ~ X - 1)
## 
## Residuals:
##      Min       1Q   Median       3Q      Max 
## -2.84941 -0.45289 -0.09686  0.57679  2.07154 
## 
## Coefficients:
##       Estimate Std. Error t value Pr(&gt;|t|)    
## Xint   0.49533    0.75410   0.657  0.51290    
## Xx1    1.95590    0.03868  50.571  &lt; 2e-16 ***
## Xx2   -0.35112    0.12600  -2.787  0.00645 ** 
## Xx2x3 -1.91126    0.13358 -14.308  &lt; 2e-16 ***
## Xx4x5  1.74247    0.24396   7.143 2.01e-10 ***
## Xx4x6 -2.83239    0.18831 -15.041  &lt; 2e-16 ***
## Xx3x7  2.10154    0.64210   3.273  0.00149 ** 
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## Residual standard error: 0.8448 on 93 degrees of freedom
## Multiple R-squared:  0.9972, Adjusted R-squared:  0.997 
## F-statistic:  4677 on 7 and 93 DF,  p-value: &lt; 2.2e-16</code></pre>
<p>Now the function for gradient descent:</p>
<div class="sourceCode" id="cb1724"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1724-1"><a href="algorithmic-optimization.html#cb1724-1" aria-hidden="true" tabindex="-1"></a>gradientDescALL <span class="ot">&lt;-</span> <span class="cf">function</span>(x, y, learnrate, conthresh, maxiter) {</span>
<span id="cb1724-2"><a href="algorithmic-optimization.html#cb1724-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">set.seed</span>(<span class="dv">123</span>)</span>
<span id="cb1724-3"><a href="algorithmic-optimization.html#cb1724-3" aria-hidden="true" tabindex="-1"></a>  b <span class="ot">&lt;-</span> <span class="fu">runif</span>(<span class="fu">ncol</span>(x), <span class="dv">0</span>, <span class="dv">1</span>)</span>
<span id="cb1724-4"><a href="algorithmic-optimization.html#cb1724-4" aria-hidden="true" tabindex="-1"></a>  yhat <span class="ot">&lt;-</span> x<span class="sc">%*%</span>b</span>
<span id="cb1724-5"><a href="algorithmic-optimization.html#cb1724-5" aria-hidden="true" tabindex="-1"></a>  e <span class="ot">&lt;-</span> y <span class="sc">-</span> yhat</span>
<span id="cb1724-6"><a href="algorithmic-optimization.html#cb1724-6" aria-hidden="true" tabindex="-1"></a>  RSS <span class="ot">&lt;-</span> <span class="fu">t</span>(e)<span class="sc">%*%</span>e</span>
<span id="cb1724-7"><a href="algorithmic-optimization.html#cb1724-7" aria-hidden="true" tabindex="-1"></a>  converged <span class="ot">=</span> F</span>
<span id="cb1724-8"><a href="algorithmic-optimization.html#cb1724-8" aria-hidden="true" tabindex="-1"></a>  iterations <span class="ot">=</span> <span class="dv">0</span></span>
<span id="cb1724-9"><a href="algorithmic-optimization.html#cb1724-9" aria-hidden="true" tabindex="-1"></a>  n <span class="ot">&lt;-</span> <span class="fu">length</span>(y)</span>
<span id="cb1724-10"><a href="algorithmic-optimization.html#cb1724-10" aria-hidden="true" tabindex="-1"></a>  <span class="cf">while</span>(converged <span class="sc">==</span> F) {</span>
<span id="cb1724-11"><a href="algorithmic-optimization.html#cb1724-11" aria-hidden="true" tabindex="-1"></a>    b_new <span class="ot">&lt;-</span> b <span class="sc">-</span> (learnrate<span class="sc">*</span>(<span class="dv">1</span><span class="sc">/</span>n))<span class="sc">*</span><span class="fu">t</span>(x)<span class="sc">%*%</span>(x<span class="sc">%*%</span>b<span class="sc">-</span>y)</span>
<span id="cb1724-12"><a href="algorithmic-optimization.html#cb1724-12" aria-hidden="true" tabindex="-1"></a>    b <span class="ot">&lt;-</span> b_new</span>
<span id="cb1724-13"><a href="algorithmic-optimization.html#cb1724-13" aria-hidden="true" tabindex="-1"></a>    yhat <span class="ot">&lt;-</span> x<span class="sc">%*%</span>b</span>
<span id="cb1724-14"><a href="algorithmic-optimization.html#cb1724-14" aria-hidden="true" tabindex="-1"></a>    e <span class="ot">&lt;-</span> y <span class="sc">-</span> yhat</span>
<span id="cb1724-15"><a href="algorithmic-optimization.html#cb1724-15" aria-hidden="true" tabindex="-1"></a>    RSS_new <span class="ot">&lt;-</span> <span class="fu">t</span>(e)<span class="sc">%*%</span>e</span>
<span id="cb1724-16"><a href="algorithmic-optimization.html#cb1724-16" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span>(RSS <span class="sc">-</span> RSS_new <span class="sc">&lt;=</span> conthresh) {</span>
<span id="cb1724-17"><a href="algorithmic-optimization.html#cb1724-17" aria-hidden="true" tabindex="-1"></a>      converged <span class="ot">=</span> T</span>
<span id="cb1724-18"><a href="algorithmic-optimization.html#cb1724-18" aria-hidden="true" tabindex="-1"></a>      <span class="fu">return</span>(b)</span>
<span id="cb1724-19"><a href="algorithmic-optimization.html#cb1724-19" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb1724-20"><a href="algorithmic-optimization.html#cb1724-20" aria-hidden="true" tabindex="-1"></a>    iterations <span class="ot">=</span> iterations <span class="sc">+</span> <span class="dv">1</span></span>
<span id="cb1724-21"><a href="algorithmic-optimization.html#cb1724-21" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span>(iterations <span class="sc">&gt;</span> maxiter) { </span>
<span id="cb1724-22"><a href="algorithmic-optimization.html#cb1724-22" aria-hidden="true" tabindex="-1"></a>      converged <span class="ot">=</span> T</span>
<span id="cb1724-23"><a href="algorithmic-optimization.html#cb1724-23" aria-hidden="true" tabindex="-1"></a>      <span class="fu">return</span>(b)</span>
<span id="cb1724-24"><a href="algorithmic-optimization.html#cb1724-24" aria-hidden="true" tabindex="-1"></a>   }</span>
<span id="cb1724-25"><a href="algorithmic-optimization.html#cb1724-25" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb1724-26"><a href="algorithmic-optimization.html#cb1724-26" aria-hidden="true" tabindex="-1"></a>}</span></code></pre></div>
<div class="sourceCode" id="cb1725"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1725-1"><a href="algorithmic-optimization.html#cb1725-1" aria-hidden="true" tabindex="-1"></a><span class="fu">gradientDescALL</span>(X, Y, <span class="fl">0.0000293</span>, <span class="fl">0.001</span>, <span class="dv">2500000</span>) <span class="co"># Ehhhh</span></span></code></pre></div>
<pre><code>##            [,1]
## int   0.7166117
## x1    1.9536609
## x2   -0.3908202
## x2x3 -1.8183423
## x4x5  1.7662375
## x4x6 -2.8377073
## x3x7  1.6405013</code></pre>
<div class="sourceCode" id="cb1727"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1727-1"><a href="algorithmic-optimization.html#cb1727-1" aria-hidden="true" tabindex="-1"></a><span class="fu">gradientDescALL</span>(X, Y, <span class="fl">0.00000293</span>, <span class="fl">0.001</span>, <span class="dv">2500000</span>) <span class="co"># Too little</span></span></code></pre></div>
<pre><code>##            [,1]
## int   0.3243014
## x1    2.0080590
## x2   -0.4608975
## x2x3 -1.5596021
## x4x5  1.0183122
## x4x6 -2.1427840
## x3x7  0.3929369</code></pre>
<div class="sourceCode" id="cb1729"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1729-1"><a href="algorithmic-optimization.html#cb1729-1" aria-hidden="true" tabindex="-1"></a><span class="fu">gradientDescALL</span>(X, Y, <span class="fl">0.000293</span>, <span class="fl">0.001</span>, <span class="dv">2500000</span>) <span class="co"># Close</span></span></code></pre></div>
<pre><code>##            [,1]
## int   0.4960033
## x1    1.9558851
## x2   -0.3512160
## x2x3 -1.9111656
## x4x5  1.7425020
## x4x6 -2.8324060
## x3x7  2.1010627</code></pre>
<div class="sourceCode" id="cb1731"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1731-1"><a href="algorithmic-optimization.html#cb1731-1" aria-hidden="true" tabindex="-1"></a><span class="fu">gradientDescALL</span>(X, Y, <span class="fl">0.00293</span>, <span class="fl">0.001</span>, <span class="dv">2500000</span>) <span class="co"># Perfect</span></span></code></pre></div>
<pre><code>##            [,1]
## int   0.4953323
## x1    1.9559022
## x2   -0.3511182
## x2x3 -1.9112623
## x4x5  1.7424723
## x4x6 -2.8323934
## x3x7  2.1015442</code></pre>
<div class="sourceCode" id="cb1733"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1733-1"><a href="algorithmic-optimization.html#cb1733-1" aria-hidden="true" tabindex="-1"></a><span class="fu">gradientDescALL</span>(X, Y, <span class="fl">0.0293</span>, <span class="fl">0.001</span>, <span class="dv">2500000</span>) <span class="co"># Too big</span></span></code></pre></div>
<pre><code>##             [,1]
## int   0.21935351
## x1    0.56900009
## x2   -0.05797943
## x2x3 -0.29563662
## x4x5  0.90067425
## x4x6 -0.06914816
## x3x7  0.30046247</code></pre>
<p>As before, the issue here is the magnitude of learning rate.</p>
</div>
</div>
<div id="optimization-with-r" class="section level2 hasAnchor" number="42.5">
<h2><span class="header-section-number">42.5</span> Optimization with R<a href="algorithmic-optimization.html#optimization-with-r" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>A good summary of tools for optimization in R given in this guide: <a href="https://cran.r-project.org/web/views/Optimization.html">Optimization and Mathematical Programming</a>. There are many optimization methods, each of which would only be appropriate for specific cases. In choosing a numerical optimization method, we need to consider following points:</p>
<ol style="list-style-type: decimal">
<li>We need to know if it’s a constrained or unconstrained problem. For example, the MLE method is an unconstrained problem. Most regularization problems, like Lasso or Ridge, are constraint optimization problems.<br />
</li>
<li>Do we know how the objective function is shaped a priori? MLE and OLS methods have well-known objective functions (Residual Sum of Squares and Log-Likelihood). Maximization and minimization problems can be used in both cases by flipping the sign of the objective function.<br />
</li>
<li>Multivariate optimization problems are much harder than single-variable optimization problems. There is, however, a large set of available optimization methods for multivariate problems.<br />
</li>
<li>In multivariate cases, the critical point is whether the objective function has available gradients. If only the objective function is available without gradient or Hessian, the Nelder-Mead algorithm is the most common method for numerical optimization. If gradients are available, the best and most used method is the gradient descent algorithm. We have seen its application for OLS. This method can be applied to MLE as well. It is also called a Steepest Descent Algorithm. In general, the gradient descent method has three types: Batch Gradient Descent, Stochastic Gradient Descent, and Mini-Batch Gradient Descent.<br />
</li>
<li>If the gradient and Hessian are available, we can also use the Newton-Raphson Method. This is only possible if the dataset is not high-dimensional, as calculating the Hessian would otherwise be very expensive.<br />
</li>
<li>Usually the Nelder-Mead method is slower than the Gradient Descent method. <code>Optim()</code> uses the Nelder-Mead method, but the optimization method can be chosen in its arguments.</li>
</ol>
<p>More details can be found in this educational <a href="http://bigdatasummerinst.sph.umich.edu/wiki/images/a/ad/Bdsi_optimization_2019.pdf">slides</a>. The most detailed and advance source is <a href="https://en.wikipedia.org/wiki/Numerical_Recipes">Numerical Recipes</a>, which uses <code>C++</code> and <code>R</code>.</p>

</div>
</div>
<h3>References<a href="references.html#references" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<div id="refs" class="references csl-bib-body hanging-indent">
<div id="ref-Gulzar_2018" class="csl-entry">
Gulzar. 2018. Cross Validated. <a href="https://stats.stackexchange.com/q/376191">https://stats.stackexchange.com/q/376191</a>.
</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="r-lab-4---simulation-in-r.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="imbalanced-data.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"whatsapp": false,
"all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": "https://github.com/yaydede/ToolShed/edit/master/37-Appendix1.Rmd",
"text": "Edit"
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": ["YA_TextBook.pdf", "YA_TextBook.epub"],
"search": {
"engine": "fuse",
"options": null
},
"toc": {
"collapse": "section"
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.9/latest.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
